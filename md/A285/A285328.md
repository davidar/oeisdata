# a\(n\) \= 1 if n is squarefree \(A005117\), otherwise a\(n\) \= Max \{m < n \| same prime factors as n, ignoring multiplicity\}\.
https://oeis.org/A285328
## JSON
```JSON
[1, 1, 1, 2, 1, 1, 1, 4, 3, 1, 1, 6, 1, 1, 1, 8, 1, 12, 1, 10, 1, 1, 1, 18, 5, 1, 9, 14, 1, 1, 1, 16, 1, 1, 1, 24, 1, 1, 1, 20, 1, 1, 1, 22, 15, 1, 1, 36, 7, 40, 1, 26, 1, 48, 1, 28, 1, 1, 1, 30, 1, 1, 21, 32, 1, 1, 1, 34, 1, 1, 1, 54, 1, 1, 45, 38, 1, 1, 1, 50, 27, 1, 1, 42, 1, 1, 1, 44, 1, 60, 1, 46, 1, 1, 1, 72, 1, 56, 33, 80, 1, 1, 1, 52, 1, 1, 1, 96]
```
## Mathematica
```Mathematica
Table[With[{r = DivisorSum[n, EulerPhi[#] Abs@ MoebiusMu[#] &]}, If[MoebiusMu@ n != 0, 1, SelectFirst[Range[n - 2, 2, -1], DivisorSum[#, EulerPhi[#] Abs@ MoebiusMu[#] &] == r &]]], {n, 108}] (* _Michael De Vlieger_, Dec 31 2018 *)
```
## Scheme
```Scheme
(definec (A285328 n) (if (not (zero? (A008683 n))) 1 (let ((k (A007947 n))) (let loop ((n (- n k))) (if (= (A007947 n) k) n (loop (- n k)))))))
```
## PARI
```PARI
A007947(n) = factorback(factorint(n)[, 1]); \\ From _Andrew Lelechenko_, May 09 2014
A285328(n) = { my(r=A007947(n)); if(core(n)==n,1,n = n-r; while(A007947(n) <> r, n = n-r); n); }; \\ After Python-code below - _Antti Karttunen_, Apr 17 2017
A285328(n) = { my(r); if((n > 1 && !bitand(n,(n-1))),(n/2), r=A007947(n); if(r==n,1,n = n-r; while(A007947(n) <> r, n = n-r); n)); }; \\ Version optimized for powers of 2.
```
## Python
```Python
from operator import mul
from sympy import primefactors
from sympy.ntheory.factor_ import core
def a007947(n): return 1 if n<2 else reduce(mul, primefactors(n))
def a(n):
    if core(n) == n: return 1
    r = a007947(n)
    k = n - r
    while k>0:
        if a007947(k) == r: return k
        else: k -= r
print([a(n) for n in range(1, 121)]) # _Indranil Ghosh_ and _Antti Karttunen_, Apr 17 2017
```
