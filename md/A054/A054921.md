# Number of connected unlabeled symmetric relations \(graphs with loops\) having n nodes\.
https://oeis.org/A054921
## JSON
```JSON
[1, 2, 3, 10, 50, 354, 3883, 67994, 2038236, 109141344, 10693855251, 1934271527050, 648399961915988, 404093642681273382, 469756524755173254759, 1022121472711196824292810, 4176802133456105622904206409, 32159648543645931290004658982846]
```
## Mathematica
```Mathematica
nn=8;
```
```Mathematica
unlabeledSimpleMluts[n_Integer]:=unlabeledSimpleMluts[n]=Total[Power[2,PermutationCycles[Ordering[Map[Sort,Select[Tuples[Range[n],2],OrderedQ]/.Table[i->Part[#,i],{i,n}]]],Length]]&/@Permutations[Range[n]]]/n!;
```
```Mathematica
multing[t_,n_]:=Array[(t+#-1)/#&,n,1,Times];
```
```Mathematica
ReplaceAll[a/@Range[0,nn],Solve[Table[unlabeledSimpleMluts[n]==If[n===0,a[0],Total[Function[ptn,Times@@(multing[a[First[#]],Length[#]]&/@Split[ptn])]/@IntegerPartitions[n]]],{n,0,nn}],a/@Range[0,nn]][[1]]] (* _Gus Wiseman_, Jul 21 2016 *)
```
## Python
```Python
from functools import lru_cache
from itertools import combinations
from math import prod, factorial, gcd
from fractions import Fraction
from sympy.utilities.iterables import partitions
from sympy import mobius, divisors
def A054921(n):
    @lru_cache(maxsize=None)
    def b(n): return int(sum(Fraction(1<<sum(p[r]*p[s]*gcd(r,s) for r,s in combinations(p.keys(),2))+sum(((q>>1)+1)*r+(q*r*(r-1)>>1) for q, r in p.items()),prod(q**r*factorial(r) for q, r in p.items())) for p in partitions(n)))
    @lru_cache(maxsize=None)
    def c(n): return n*b(n)-sum(c(k)*b(n-k) for k in range(1,n))
    return sum(mobius(d)*c(n//d) for d in divisors(n,generator=True))//n if n else 1 # _Chai Wah Wu_, Jul 10 2024
```
