# Toothpick sequence \(see Comments lines for definition\)\.
https://oeis.org/A139250
## JSON
```JSON
[0, 1, 3, 7, 11, 15, 23, 35, 43, 47, 55, 67, 79, 95, 123, 155, 171, 175, 183, 195, 207, 223, 251, 283, 303, 319, 347, 383, 423, 483, 571, 651, 683, 687, 695, 707, 719, 735, 763, 795, 815, 831, 859, 895, 935, 995, 1083, 1163, 1199, 1215, 1243, 1279, 1319, 1379]
```
## Maple
```Maple
G := (x/((1-x)*(1+2*x))) * (1 + 2*x*mul(1+x^(2^k-1)+2*x^(2^k),k=0..20)); # _N. J. A. Sloane_, May 20 2009, Jun 05 2009
# From _N. J. A. Sloane_, Dec 25 2009: A139250 is T, A139251 is a.
a:=[0,1,2,4]; T:=[0,1,3,7]; M:=10;
for k from 1 to M do
a:=[op(a),2^(k+1)];
T:=[op(T),T[nops(T)]+a[nops(a)]];
for j from 1 to 2^(k+1)-1 do
a:=[op(a), 2*a[j+1]+a[j+2]];
T:=[op(T),T[nops(T)]+a[nops(a)]];
od: od: a; T;
```
## Mathematica
```Mathematica
CoefficientList[ Series[ (x/((1 - x)*(1 + 2x))) (1 + 2x*Product[1 + x^(2^k - 1) + 2*x^(2^k), {k, 0, 20}]), {x, 0, 53}], x] (* _Robert G. Wilson v_, Dec 06 2010 *)
```
```Mathematica
a[0] = 0; a[n_] := a[n] = Module[{m, k}, m = 2^(Length[IntegerDigits[n, 2]] - 1); k = (2m^2+1)/3; If[n == m, k, k + 2 a[n - m] + a[n - m + 1] - 1]]; Table[a[n], {n, 0, 100}] (* _Jean-Fran√ßois Alcover_, Oct 06 2018, after _David A. Corneth_ *)
```
## PARI
```PARI
A139250(n,print_all=0)={my(p=[], /* set of "used" points. Points are written as complex numbers, c=x+iy. Toothpicks are of length 2 */
ee=[[0,1]], /* list of (exposed) endpoints. Exposed endpoints are listed as [c,d] where c=x+iy is the position of the endpoint, and d (unimodular) is the direction */
c,d,ne, cnt=1); print_all && print1("0,1"); n<2 && return(n);
for(i=2,n, p=setunion(p, Set(Mat(ee~)[,1])); /* add endpoints (discard directions) from last move to "used" points */
ne=[]; /* new (exposed) endpoints */
for( k=1, #ee, /* add endpoints of new toothpicks if not among the used points */
setsearch(p, c=ee[k][1]+d=ee[k][2]*I) || ne=setunion(ne,Set([[c,d]]));
setsearch(p, c-2*d) || ne=setunion(ne,Set([[c-2*d,-d]]));
); /* using Set() we have the points sorted, so it's easy to remove those which finally are not exposed because they touch a new toothpick */
forstep( k=#ee=eval(ne), 2, -1, ee[k][1]==ee[k-1][1] && k-- && ee=vecextract(ee,Str("^"k"..",k+1)));
cnt+=#ee; /* each exposed endpoint will give a new toothpick */
print_all && print1(","cnt));cnt} \\ _M. F. Hasler_, Apr 14 2009
```
```PARI
\\works for n > 0
a(n) = {my(k = (2*msb(n)^2 + 1) / 3); if(n==msb(n),k , k + 2*a(n-msb(n)) + a(n - msb(n) + 1) - 1)}
msb(n)=my(t=0);while(n>>t>0,t++);2^(t-1)\\ _David A. Corneth_, Mar 26 2015
```
## Python
```Python
def msb(n):
    t = 0
    while n>>t > 0:
        t += 1
    return 2**(t - 1)
def a(n):
    k = (2 * msb(n)**2 + 1) / 3
    return 0 if n == 0 else k if n == msb(n) else k + 2*a(n - msb(n)) + a(n - msb(n) + 1) - 1
[a(n) for n in range(101)]  # _Indranil Ghosh_, Jul 01 2017, after _David A. Corneth_'s PARI script
```
