# a\(n\) is the least number k greater than n such that the square roots of both k and n have continuous fractions with the same period p and, if p \> 1, the same periodic terms except for the last term\.
https://oeis.org/A334116
## JSON
```JSON
[1, 5, 8, 4, 10, 12, 32, 15, 9, 17, 40, 20, 74, 33, 24, 16, 26, 39, 1880, 30, 112, 660, 96, 35, 25, 37, 104, 299, 338, 42, 77600, 75, 60, 78, 48, 36, 50, 84, 68, 87, 130, 56, 288968, 468, 350, 3242817, 192, 63, 49, 65, 200, 2726, 1042, 1628, 180, 72, 308, 425, 5880, 95]
```
## Maxima
```Maxima
block([nmax: 100],
/*saves the first nmax terms in the current directory*/
algebraic: true, local(coeff), showtime: true,
fl: openw(sconcat("terms",nmax, ".txt")),
coeff(w,m):=
  block(a: m, p: 0, s: w, vv:[],
   while a<2*m do
    (p: p+1, s: ratsimp(1/(s-floor(s))), a: floor(s),
     if a<2*m then vv: append(vv, [a])),
   j: floor((p-1)/2),
   if mod(p,2)=0 then v: [1,0,vv[j+1]] else v: [0,1,1],
   for i from j thru 1 step(-1) do
    (h: vv[i], u: [v[1]+h*v[3], v[3], 2*h*v[1]+v[2]+h^2*v[3]], v: u),
   return(v)),
   for n from 1 thru nmax do
    (w: sqrt(n), m: floor(w),
     if w=m then  b: n else
      (v: coeff(w,m),  x: v[1], y: v[2], z: v[3], q: mod(z,2),
       if q=0 then (z: z/2, y: y/2) else x: 2*x,
       fr: (x*m+y)/z, m: m+z, fr: fr+x, b: m^2+fr),
      printf( fl, "~d, ", b)),
      close(fl));
```
## Python
```Python
from sympy import floor, S, sqrt
def coeff(w,m):
    a, p, s, vv = m, 0, w, []
    while a < 2*m:
        p += 1
        s = S.One/(s-floor(s))
        a = floor(s)
        if a < 2*m:
            vv.append(a)
    j = (p-1)//2
    v = [0,1,1] if p % 2 else [1, 0, vv[j]]
    for i in range(j-1,-1,-1):
        h = vv[i]
        v = [v[0]+h*v[2], v[2], 2*h*v[0]+v[1]+h**2*v[2]]
    return v
def A334116(n):
    w = sqrt(n)
    m = floor(w)
    if w == m:
        return n
    else:
        x, y, z = coeff(w,m)
        if z % 2:
            x *= 2
        else:
            z //= 2
            y //= 2
        return (m+z)**2+x+(x*m+y)//z # _Chai Wah Wu_, Sep 30 2021, after Maxima code
```
