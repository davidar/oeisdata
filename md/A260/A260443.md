# Prime factorization representation of Stern polynomials: a\(0\) \= 1, a\(1\) \= 2, a\(2n\) \= A003961\(a\(n\)\), a\(2n\+1\) \= a\(n\)\*a\(n\+1\)\.
https://oeis.org/A260443
## JSON
```JSON
[1, 2, 3, 6, 5, 18, 15, 30, 7, 90, 75, 270, 35, 450, 105, 210, 11, 630, 525, 6750, 245, 20250, 2625, 9450, 77, 15750, 3675, 47250, 385, 22050, 1155, 2310, 13, 6930, 5775, 330750, 2695, 3543750, 128625, 1653750, 847, 4961250, 643125, 53156250, 18865, 24806250, 202125, 727650, 143, 1212750, 282975, 57881250, 29645, 173643750, 1414875, 18191250, 1001]
```
## Maple
```Maple
b:= n-> mul(nextprime(i[1])^i[2], i=ifactors(n)[2]):
a:= proc(n) option remember; `if`(n<2, n+1,
      `if`(irem(n, 2, 'h')=0, b(a(h)), a(h)*a(n-h)))
    end:
seq(a(n), n=0..56);  # _Alois P. Heinz_, Jul 04 2024
```
## Mathematica
```Mathematica
a[n_] := a[n] = Which[n < 2, n + 1, EvenQ@ n, Times @@ Map[#1^#2 & @@ # &, FactorInteger[#] /. {p_, e_} /; e > 0 :> {Prime[PrimePi@ p + 1], e}] - Boole[# == 1] &@ a[n/2], True, a[#] a[# + 1] &[(n - 1)/2]]; Table[a@ n, {n, 0, 56}] (* _Michael De Vlieger_, Apr 05 2017 *)
```
## PARI
```PARI
A003961(n) = my(f = factor(n)); for (i=1, #f~, f[i, 1] = nextprime(f[i, 1]+1)); factorback(f); \\ From _Michel Marcus_
A260443(n) = if(n<2, n+1, if(n%2, A260443(n\2)*A260443(n\2+1), A003961(A260443(n\2)))); \\ After _Charles R Greathouse IV_'s code for "ps" in A186891.
\\ _Antti Karttunen_, Oct 11 2016
```
## Scheme
```Scheme
;; Uses memoization-macro definec:
(definec (A260443 n) (cond ((<= n 1) (+ 1 n)) ((even? n) (A003961 (A260443 (/ n 2)))) (else (* (A260443 (/ (- n 1) 2)) (A260443 (/ (+ n 1) 2))))))
;; A more standalone version added Oct 10 2016, requiring only an implementation of A000040 and the memoization-macro definec:
(define (A260443 n) (product_primes_to_kth_powers (A260443as_coeff_list n)))
(define (product_primes_to_kth_powers nums) (let loop ((p 1) (nums nums) (i 1)) (cond ((null? nums) p) (else (loop (* p (expt (A000040 i) (car nums))) (cdr nums) (+ 1 i))))))
(definec (A260443as_coeff_list n) (cond ((zero? n) (list)) ((= 1 n) (list 1)) ((even? n) (cons 0 (A260443as_coeff_list (/ n 2)))) (else (add_two_lists (A260443as_coeff_list (/ (- n 1) 2)) (A260443as_coeff_list (/ (+ n 1) 2))))))
(define (add_two_lists nums1 nums2) (let ((len1 (length nums1)) (len2 (length nums2))) (cond ((< len1 len2) (add_two_lists nums2 nums1)) (else (map + nums1 (append nums2 (make-list (- len1 len2) 0)))))))
```
## Python
```Python
from sympy import factorint, prime, primepi
from functools import reduce
from operator import mul
def a003961(n):
    F = factorint(n)
    return 1 if n==1 else reduce(mul, (prime(primepi(i) + 1)**F[i] for i in F))
def a(n): return n + 1 if n<2 else a003961(a(n//2)) if n%2==0 else a((n - 1)//2)*a((n + 1)//2)
print([a(n) for n in range(101)]) # _Indranil Ghosh_, Jun 21 2017
```
