# a\(n\) is the smallest nonzero number k such that gcd\(prime\(1\)^k \+ 1, prime\(2\)^k \+ 1, \.\.\., prime\(n\)^k \+ 1\) \> 1 and gcd\(prime\(1\)^k \+ 1, prime\(2\)^k \+ 1, \.\.\., prime\(n\+1\)^k \+ 1\) \= 1\.
https://oeis.org/A351921
## JSON
```JSON
[2, 26, 21, 86, 33, 1238, 4401, 4586, 16161, 18561, 81, 37046, 85478, 180146, 339866]
```
## Mathematica
```Mathematica
a[n_] := Module[{k = 1, p = Prime[Range[n + 1]]}, While[GCD @@ (Most[p]^k + 1) == 1 || GCD @@ (p^k + 1) > 1, k++]; k]; Array[a, 10, 2] (* _Amiram Eldar_, Feb 26 2022 *)
```
## Python
```Python
from sympy import sieve
from math import gcd
from functools import reduce
sieve.extend_to_no(50)
pr = list(sieve._list)
terms = [0]*100
for i in range(2, 85478+1):
    k,g,len_f = 1,2,0
    while g != 1:
        k += 1
        len_f += 1
        g = reduce(gcd, [t**i + 1 for t in pr[:k]])
    if len_f > 1 and terms[len_f] == 0:
        terms[len_f] = i
print(terms[2:15])
```
## PARI
```PARI
isok(k, n) = my(v = vector(n+1, i, prime(i)^k+1)); (gcd(v) == 1) && (gcd(Vec(v, n)) != 1);
a(n) = my(k=1); while (!isok(k, n), k++); k; \\ _Michel Marcus_, Mar 18 2022
```
