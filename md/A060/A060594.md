# Number of solutions to x^2 \=\= 1 \(mod n\), that is, square roots of unity modulo n\.
https://oeis.org/A060594
## JSON
```JSON
[1, 1, 2, 2, 2, 2, 2, 4, 2, 2, 2, 4, 2, 2, 4, 4, 2, 2, 2, 4, 4, 2, 2, 8, 2, 2, 2, 4, 2, 4, 2, 4, 4, 2, 4, 4, 2, 2, 4, 8, 2, 4, 2, 4, 4, 2, 2, 8, 2, 2, 4, 4, 2, 2, 4, 8, 4, 2, 2, 8, 2, 2, 4, 4, 4, 4, 2, 4, 4, 4, 2, 8, 2, 2, 4, 4, 4, 4, 2, 8, 2, 2, 2, 8, 4, 2, 4, 8, 2, 4, 4, 4, 4, 2, 4, 8, 2, 2, 4, 4, 2, 4, 2]
```
## Maple
```Maple
A060594 := proc(n)
   option remember;
   local a,b,c;
   if type(n,even) then
     a:= padic:-ordp(n,2);
     b:= 2^a;
     c:= n/b;
     min(b/2, 4) * procname(c)
   else
     2^nops(numtheory:-factorset(n))
   fi
end proc:
map(A060594, [$1 .. 100]); # _Robert Israel_, Jan 05 2015
```
## Mathematica
```Mathematica
a[n_] := Sum[ Boole[ Mod[k^2 , n] == 1], {k, 1, n}]; a[1] = 1; Table[a[n], {n, 1, 103}] (* _Jean-François Alcover_, Oct 21 2011 *)
```
```Mathematica
a[n_] := Switch[Mod[n, 8], 2|6, 2^(PrimeNu[n]-1), 1|3|4|5|7, 2^PrimeNu[n], 0, 2^(PrimeNu[n]+1)]; Array[a, 103] (* _Jean-François Alcover_, Apr 09 2016 *)
```
## PARI
```PARI
a(n)=sum(i=1,n,if((i^2-1)%n,0,1))
```
```PARI
a(n)=my(o=valuation(n,2));2^(omega(n>>o)+max(min(o-1,2),0)) \\ _Charles R Greathouse IV_, Jun 06 2013
```
```PARI
a(n)=if(n<=2, 1, 2^#znstar(n)[3] ); \\ _Joerg Arndt_, Jan 06 2015
```
## Sage
```Sage
print([len(Integers(n).square_roots_of_one()) for n in range(1,100)]) # _Ralf Stephan_, Mar 30 2014
```
## Python
```Python
from sympy import primefactors
def a007814(n): return 1 + bin(n - 1).count('1') - bin(n).count('1')
def a(n):
    if n%2==0:
        A=a007814(n)
        b=2**A
        c=n//b
        return min(b//2, 4)*a(c)
    else: return 2**len(primefactors(n))
print([a(n) for n in range(1, 101)]) # _Indranil Ghosh_, Jul 18 2017, after the Maple program
```
```Python
from sympy import primefactors
def A060594(n): return (1<<len(primefactors(n>>(s:=(~n & n-1).bit_length()))))*(1 if n&1 else 1<<min(2,s-1)) # _Chai Wah Wu_, Oct 26 2022
```
