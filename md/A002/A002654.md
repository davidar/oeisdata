# Number of ways of writing n as a sum of at most two nonzero squares, where order matters; also \(number of divisors of n of form 4m\+1\) \- \(number of divisors of form 4m\+3\)\.
https://oeis.org/A002654
## JSON
```JSON
[1, 1, 0, 1, 2, 0, 0, 1, 1, 2, 0, 0, 2, 0, 0, 1, 2, 1, 0, 2, 0, 0, 0, 0, 3, 2, 0, 0, 2, 0, 0, 1, 0, 2, 0, 1, 2, 0, 0, 2, 2, 0, 0, 0, 2, 0, 0, 0, 1, 3, 0, 2, 2, 0, 0, 0, 0, 2, 0, 0, 2, 0, 0, 1, 4, 0, 0, 2, 0, 0, 0, 1, 2, 2, 0, 0, 0, 0, 0, 2, 1, 2, 0, 0, 4, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 2, 1, 0, 3, 2, 0, 0, 2, 0]
```
## Maple
```Maple
with(numtheory):
A002654 := proc(n)
    local count1, count3, d;
    count1 := 0:
    count3 := 0:
    for d in numtheory[divisors](n) do
        if d mod 4 = 1 then
            count1 := count1+1
        elif d mod 4 = 3 then
            count3 := count3+1
        fi:
    end do:
    count1-count3;
end proc:
# second Maple program:
a:= n-> add(`if`(d::odd, (-1)^((d-1)/2), 0), d=numtheory[divisors](n)):
seq(a(n), n=1..100);  # _Alois P. Heinz_, Feb 04 2020
```
## Mathematica
```Mathematica
a[n_] := Count[Divisors[n], d_ /; Mod[d, 4] == 1] - Count[Divisors[n], d_ /; Mod[d, 4] == 3]; a/@Range[105] (* _Jean-François Alcover_, Apr 06 2011, after _R. J. Mathar_ *)
```
```Mathematica
QP = QPochhammer; CoefficientList[(1/q)*(QP[q^2]^10/(QP[q]*QP[q^4])^4-1)/4 + O[q]^100, q] (* _Jean-François Alcover_, Nov 24 2015 *)
```
```Mathematica
f[2, e_] := 1; f[p_, e_] := If[Mod[p, 4] == 1, e + 1, Mod[e + 1, 2]]; a[1] = 1; a[n_] := Times @@ f @@@ FactorInteger[n]; Array[a, 100] (* _Amiram Eldar_, Sep 19 2020 *)
```
```Mathematica
Rest[CoefficientList[Series[EllipticTheta[3, 0, q]^2/4, {q, 0, 100}], q]] (* _Vaclav Kotesovec_, Mar 10 2023 *)
```
## PARI
```PARI
direuler(p=2,101,1/(1-X)/(1-kronecker(-4,p)*X))
```
```PARI
{a(n) = polcoeff( sum(k=1, n, x^k / (1 + x^(2*k)), x * O(x^n)), n)}
```
```PARI
{a(n) = sumdiv( n, d, (d%4==1) - (d%4==3))}
```
```PARI
{a(n) = local(A); A = x * O(x^n); polcoeff( eta(x^2 + A)^10 / (eta(x + A) * eta(x^4 + A))^4 / 4, n)} \\ _Michael Somos_, Jun 03 2005
```
```PARI
a(n)=my(f=factor(n>>valuation(n,2))); prod(i=1,#f~, if(f[i,1]%4==1, f[i,2]+1, (f[i,2]+1)%2)) \\ _Charles R Greathouse IV_, Sep 09 2014
```
```PARI
my(B=bnfinit(x^2+1)); vector(100,n,#bnfisintnorm(B,n)) \\ _Joerg Arndt_, Jun 01 2024
```
## Haskell
```Haskell
a002654 n = product $ zipWith f (a027748_row m) (a124010_row m) where
   f p e | p `mod` 4 == 1 = e + 1
         | otherwise      = (e + 1) `mod` 2
   m = a000265 n
-- _Reinhard Zumkeller_, Mar 18 2013
```
## Python
```Python
from math import prod
from sympy import factorint
def A002654(n): return prod(1 if p == 2 else (e+1 if p % 4 == 1 else (e+1) % 2) for p, e in factorint(n).items()) # _Chai Wah Wu_, May 09 2022
```
