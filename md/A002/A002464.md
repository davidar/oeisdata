# Hertzsprung's problem: ways to arrange n non\-attacking kings on an n X n board, with 1 in each row and column\. Also number of permutations of length n without rising or falling successions\.
https://oeis.org/A002464
## JSON
```JSON
[1, 1, 0, 0, 2, 14, 90, 646, 5242, 47622, 479306, 5296790, 63779034, 831283558, 11661506218, 175203184374, 2806878055610, 47767457130566, 860568917787402, 16362838542699862, 327460573946510746, 6880329406055690790, 151436547414562736234, 3484423186862152966838]
```
## Maple
```Maple
A002464 := proc(n) options remember; if n <= 1 then 1 elif n <= 3 then 0 else (n+1)*A002464(n-1)-(n-2)*A002464(n-2)-(n-5)*A002464(n-3)+(n-3)*A002464(n-4); fi; end;
```
## Mathematica
```Mathematica
(* computation from the permutation class *)
```
```Mathematica
g[ L_ ] := Apply[ And, Map[ #>1&, L ] ]; f[ n_ ] := Length[ Select[ Permutations[ Range[ n ] ], g[ Rest[ Abs[ RotateRight[ # ]-# ] ] ]& ] ]; Table[ f[ n ], {n, 1, 8} ] (* _Erich Friedman_ *)
```
```Mathematica
(* or direct computation of terms *)
```
```Mathematica
Table[n! + Sum[(-1)^r*(n-r)!*Sum[2^c *Binomial[r-1,c-1] *Binomial[n-r,c], {c,1,r}], {r,1,n-1}], {n,1,30}] (* _Vaclav Kotesovec_, Mar 28 2011 *)
```
```Mathematica
(* or from g.f. *)
```
```Mathematica
M = 30; CoefficientList[Sum[n!*x^n*(1-x)^n/(1+x)^n, {n, 0, M}] + O[x]^M, x] (* _Jean-Fran√ßois Alcover_, Jul 07 2015 *)
```
```Mathematica
CoefficientList[Series[Exp[(1 + x)/((-1 + x) x)] (1 + x) Gamma[0, (1 + x)/((-1 + x) x)]/((-1 + x) x), {x, 0, 20}], x] (* _Eric W. Weisstein_, Apr 11 2018 *)
```
```Mathematica
RecurrenceTable[{a[n] == (n + 1) a[n - 1] - (n - 2) a[n - 2] - (n - 5) a[n - 3] + (n - 3) a[n - 4], a[0] == a[1] == 1, a[2] == a[3] == 0}, a, {n, 0, 20}] (* _Eric W. Weisstein_, Apr 11 2018 *)
```
## PARI
```PARI
N = 66;  x = 'x + O('x^N);
gf = sum(n=0,N, n!*(x*(1-x))^n/(1+x)^n );
v = Vec(gf) /* _Joerg Arndt_, Apr 17 2013 */
```
## Python
```Python
from math import factorial, comb
def A002464(n): return factorial(n)+sum((-1 if k&1 else 1)*factorial(n-k)*sum(comb(k-1,t-1)*comb(n-k,t)<<t for t in range(1,k+1)) for k in range(1,n+1)) # _Chai Wah Wu_, Feb 19 2024
```
