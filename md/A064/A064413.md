# EKG sequence \(or ECG sequence\): a\(1\) \= 1; a\(2\) \= 2; for n \> 2, a\(n\) \= smallest number not already used which shares a factor with a\(n\-1\)\.
https://oeis.org/A064413
## JSON
```JSON
[1, 2, 4, 6, 3, 9, 12, 8, 10, 5, 15, 18, 14, 7, 21, 24, 16, 20, 22, 11, 33, 27, 30, 25, 35, 28, 26, 13, 39, 36, 32, 34, 17, 51, 42, 38, 19, 57, 45, 40, 44, 46, 23, 69, 48, 50, 52, 54, 56, 49, 63, 60, 55, 65, 70, 58, 29, 87, 66, 62, 31, 93, 72, 64, 68, 74, 37, 111, 75, 78, 76, 80, 82]
```
## Maple
```Maple
h := array(1..20000); a := array(1..10000); maxa := 300; maxn := 2*maxa; for n from 1 to maxn do h[n] := -1; od: a[1] := 2; h[2] := 1; c := 2; for n from 2 to maxa do for m from 2 to maxn do t1 := gcd(m,c); if t1 > 1 and h[m] = -1 then c := m; a[n] := c; h[c] := n; break; fi; od: od: ap := []: for n from 1 to maxa do ap := [op(ap),a[n]]; od: hp := []: for n from 2 to maxa do hp := [op(hp),h[n]]; od: convert(ap,list); convert(hp,list); # this is very crude!
N:= 1000: # to get terms before the first term > N
V:= Vector(N):
A[1]:= 1:
A[2]:= 2: V[2]:= 1:
for n from 3 do
  S:= {seq(seq(k*p,k=1..N/p),p=numtheory:-factorset(A[n-1]))};
  for s in sort(convert(S,list)) do
    if V[s] = 0 then
      A[n]:= s;
      break
    fi
  od;
  if V[s] = 1 then break fi;
  V[s]:= 1;
od:
seq(A[i],i=1..n-1); # _Robert Israel_, Jan 18 2016
```
## Mathematica
```Mathematica
maxN = 100; ekg = {1, 2}; unused = Range[3, maxN]; found = True; While[found, found = False; i = 0; While[ !found && i < Length[unused], i++; If[GCD[ekg[[-1]], unused[[i]]] > 1, found = True; AppendTo[ekg, unused[[i]]]; unused = Delete[unused, i]]]]; ekg (* Ayres *)
```
```Mathematica
ekGrapher[s_List] := Block[{m = s[[-1]], k = 3}, While[MemberQ[s, k] || GCD[m, k] == 1, k++ ]; Append[s, k]]; Nest[ekGrapher, {1, 2}, 71] (* _Robert G. Wilson v_, May 20 2009 *)
```
## Haskell
```Haskell
import Data.List (delete, genericIndex)
a064413 n = genericIndex a064413_list (n - 1)
a064413_list = 1 : f 2 [2..] where
   ekg x zs = f zs where
       f (y:ys) = if gcd x y > 1 then y : ekg y (delete y zs) else f ys
-- _Reinhard Zumkeller_, May 01 2014, Sep 17 2011
```
## PARI
```PARI
a1=1; a2=2; v=[1,2];
for(n=3,100,a3=if(n<0,0,t=1;while(vecmin(vector(length(v),i,abs(v[i]-t)))*(gcd(a2,t)-1)==0,t++);t);a2=a3;v=concat(v,a3););
a(n)=v[n];
/* _Benoit Cloitre_, Sep 23 2012 */
```
## Python
```Python
from fractions import gcd
A064413_list, l, s, b = [1,2], 2, 3, {}
for _ in range(10**5):
....i = s
....while True:
........if not i in b and gcd(i,l) > 1:
............A064413_list.append(i)
............l, b[i] = i, True
............while s in b:
................b.pop(s)
................s += 1
............break
........i += 1 # _Chai Wah Wu_, Dec 08 2014
```
