# Somos\-4 sequence: a\(0\)\=a\(1\)\=a\(2\)\=a\(3\)\=1; for n \>\= 4, a\(n\) \= \(a\(n\-1\) \* a\(n\-3\) \+ a\(n\-2\)^2\) / a\(n\-4\)\.
https://oeis.org/A006720
## JSON
```JSON
[1, 1, 1, 1, 2, 3, 7, 23, 59, 314, 1529, 8209, 83313, 620297, 7869898, 126742987, 1687054711, 47301104551, 1123424582771, 32606721084786, 1662315215971057, 61958046554226593, 4257998884448335457, 334806306946199122193, 23385756731869683322514, 3416372868727801226636179]
```
## Maple
```Maple
Digits:=11; f(x):=4*x^3-4*x+1;sols:=evalf(solve(f(x),x)); e1:=Re(sols[1]); e3:=Re(sols[2]); w1:=evalf(Int((f(x))^(-0.5),x=e1..infinity)); w3:=I*evalf(Int((-f(x))^(-0.5),x=-infinity..e3)); k:=2*w1-evalf(Int((f(x))^(-0.5),x=1..infinity)); z0:=w3+evalf(Int((f(x))^(-0.5),x=e3..-1)); A:=1/WeierstrassSigma(z0,4.0,-1.0); B:=WeierstrassSigma(k,4.0,-1.0)/WeierstrassSigma(z0+k,4.0,-1.0)/A; for n from 0 to 10 do a[n]:=A*B^n*WeierstrassSigma(z0+n*k,4.0,-1.0)/(WeierstrassSigma(k,4.0,-1.0))^(n^2) od; # _Andrew Hone_, Oct 12 2005
A006720 := proc(n)
    option remember;
    if n <= 3 then
        1;
    else
        (procname(n-1)*procname(n-3)+procname(n-2)^2)/procname(n-4) ;
    end if;
end proc: # _R. J. Mathar_, Jul 12 2012
```
## Mathematica
```Mathematica
a[0] = a[1] = a[2] = a[3] = 1; a[n_] := a[n] = (a[n - 1] a[n - 3] + a[n - 2]^2)/a[n - 4]; Array[a, 23] (* _Robert G. Wilson v_, Jul 04 2007 *)
```
```Mathematica
RecurrenceTable[{a[0]==a[1]==a[2]==a[3]==1,a[n]==(a[n-1]a[n-3]+a[n-2]^2)/ a[n-4]},a,{n,30}] (* _Harvey P. Dale_, Apr 07 2018 *)
```
```Mathematica
b[ n_] := If[-2<=n<=2, {2, 1, 1, 3, 23}[[n+3]], 2*a[n+2]^3*a[n+3] + a[n+1]^2*(a[n+3]*a[n+4] - a[n+2]*a[n+5])]; a[ n_] := If[OddQ[n], b[(n-3)/2], b[-n/2]]; (* _Michael Somos_, Feb 28 2022 *)
```
## PARI
```PARI
a=vector(99);a[1]=a[2]=a[3]=a[4]=1;for(n=5,#a,a[n]=(a[n-1]*a[n-3]+a[n-2]^2)/a[n-4]); a \\ _Charles R Greathouse IV_, Jun 16 2011
```
## Haskell
```Haskell
a006720 n = a006720_list !! n
a006720_list = [1,1,1,1] ++
   zipWith div (foldr1 (zipWith (+)) (map b [1..2])) a006720_list
   where b i = zipWith (*) (drop i a006720_list) (drop (4-i) a006720_list)
-- _Reinhard Zumkeller_, Jan 22 2012
```
## Python
```Python
from gmpy2 import divexact
A006720 = [1, 1, 1, 1]
for n in range(4, 101):
    A006720.append(divexact(A006720[n-1]*A006720[n-3]+A006720[n-2]**2,A006720[n-4]))
# _Chai Wah Wu_, Sep 01 2014
```
## Magma
```Magma
I:=[1,1,1,1]; [n le 4 select I[n] else (Self(n-1)*Self(n-3)+Self(n-2)^2)/Self(n-4): n in [1..30]]; // _Vincenzo Librandi_, Aug 07 2017
```
