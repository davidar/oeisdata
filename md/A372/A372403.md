# Number of k < 2^n that are neither squarefree nor prime powers\.
https://oeis.org/A372403
## JSON
```JSON
[1, 5, 16, 37, 83, 178, 374, 772, 1565, 3160, 6361, 12770, 25599, 51265, 102634, 205374, 410873, 821924, 1644070, 3288433, 6577231, 13154868, 26310347, 52621521, 105244142, 210489792, 420981295, 841964929, 1683933254, 3367871086, 6735748322, 13471504796, 26943020642]
```
## Maple
```Maple
filter:= proc(n) local F;
  F:= ifactors(n)[2];
  nops(F) > 1 and max(F[..,2]) > 1
end proc:
R:= NULL: v:= 0:
for i from 4 to 20 do
  v:= v + nops(select(filter, [$2^(i-1)+1 .. 2^i-1]));
  R:= R,v;
od:
R; # _Robert Israel_, Jun 09 2024
```
## Mathematica
```Mathematica
nn = 2^20; m = 2; c = 0;
```
```Mathematica
Reap[Do[If[Nor[PrimePowerQ[n], SquareFreeQ[n]], c++];
```
```Mathematica
  If[n >= m, m *= 2; Sow[c]], {n, nn}] ][[-1, 1]]
```
## Python
```Python
from math import isqrt
from sympy import mobius, nextprime, integer_log
def A372403(n):
    m, p = (1<<n)-1, 2
    q = isqrt(m)
    r = m-sum(mobius(k)*(m//k**2) for k in range(1,q+1))
    while p<=q:
        r -= integer_log(m,p)[0]-1
        p = nextprime(p)
    return r # _Chai Wah Wu_, Jun 10 2024
```
