# Perfect powers: m^k where m \> 0 and k \>\= 2\.
https://oeis.org/A001597
## JSON
```JSON
[1, 4, 8, 9, 16, 25, 27, 32, 36, 49, 64, 81, 100, 121, 125, 128, 144, 169, 196, 216, 225, 243, 256, 289, 324, 343, 361, 400, 441, 484, 512, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1000, 1024, 1089, 1156, 1225, 1296, 1331, 1369, 1444, 1521, 1600, 1681, 1728, 1764]
```
## Maple
```Maple
isA001597 := proc(n)
    local e ;
    e := seq(op(2,p),p=ifactors(n)[2]) ;
    return ( igcd(e) >=2 or n =1 ) ;
end proc:
A001597 := proc(n)
    option remember;
    local a;
    if n = 1 then
        1;
    else
        for a from procname(n-1)+1 do
            if isA001597(a) then
                return a ;
            end if;
         end do;
    end if;
end proc:
seq(A001597(n),n=1..70) ; # _R. J. Mathar_, Jun 07 2011
N:= 10000: # to get all entries <= N
sort({1,seq(seq(a^b, b = 2 .. floor(log[a](N))), a = 2 .. floor(sqrt(N)))}); # _Robert FERREOL_, Jul 18 2023
```
## Mathematica
```Mathematica
min = 0; max = 10^4;  Union@ Flatten@ Table[ n^expo, {expo, Prime@ Range@ PrimePi@ Log2@ max}, {n, Floor[1 + min^(1/expo)], max^(1/expo)}] (* _T. D. Noe_, Apr 18 2011; slightly modified by _Robert G. Wilson v_, Aug 11 2014 *)
```
```Mathematica
perfectPowerQ[n_] := n == 1 || GCD @@ FactorInteger[n][[All, 2]] > 1; Select[Range@ 1765, perfectPowerQ] (* _Ant King_, Jun 29 2013; slightly modified by _Robert G. Wilson v_, Aug 11 2014 *)
```
```Mathematica
nextPerfectPower[n_] := If[n == 1, 4, Min@ Table[ (Floor[n^(1/k)] + 1)^k, {k, 2, 1 + Floor@ Log2@ n}]]; NestList[ nextPerfectPower, 1, 55] (* _Robert G. Wilson v_, Aug 11 2014 *)
```
```Mathematica
Join[{1},Select[Range[2000],GCD@@FactorInteger[#][[All,2]]>1&]] (* _Harvey P. Dale_, Apr 30 2018 *)
```
## Magma
```Magma
[1] cat [n : n in [2..1000] | IsPower(n) ];
```
## PARI
```PARI
{a(n) = local(m, c); if( n<2, n==1, c=1; m=1; while( c<n, m++; if( ispower(m), c++)); m)} /* _Michael Somos_, Aug 05 2009 */
```
```PARI
is(n)=ispower(n) || n==1 \\ _Charles R Greathouse IV_, Sep 16 2015
```
```PARI
list(lim)=my(v=List(vector(sqrtint(lim\=1),n,n^2))); for(e=3,logint(lim,2), for(n=2,sqrtnint(lim,e), listput(v,n^e))); Set(v) \\ _Charles R Greathouse IV_, Dec 10 2019
```
## Sage
```Sage
def A001597_list(n) :
    return [k for k in (1..n) if k.is_perfect_power()]
A001597_list(1764) # _Peter Luschny_, Feb 03 2012
```
## Haskell
```Haskell
import Data.Map (singleton, findMin, deleteMin, insert)
a001597 n = a001597_list !! (n-1)
(a001597_list, a025478_list, a025479_list) =
   unzip3 $ (1, 1, 2) : f 9 (3, 2) (singleton 4 (2, 2)) where
   f zz (bz, ez) m
    | xx < zz = (xx, bx, ex) :
                f zz (bz, ez+1) (insert (bx*xx) (bx, ex+1) $ deleteMin m)
    | xx > zz = (zz, bz, 2) :
                f (zz+2*bz+1) (bz+1, 2) (insert (bz*zz) (bz, 3) m)
    | otherwise = f (zz+2*bz+1) (bz+1, 2) m
    where (xx, (bx, ex)) = findMin m  --  bx ^ ex == xx
-- _Reinhard Zumkeller_, Mar 28 2014, Oct 04 2012, Apr 13 2012
```
## Python
```Python
from sympy import perfect_power
def ok(n): return n==1 or perfect_power(n)
print([m for m in range(1, 1765) if ok(m)]) # _Michael S. Branicky_, Jan 04 2021
```
```Python
import sympy
class A001597() :
    def __init__(self) :
        self.a = [1]
    def at(self, n):
        if n <= len(self.a):
            return self.a[n-1]
        else:
            cand = self.at(n-1)+1
            while sympy.perfect_power(cand) == False:
                cand += 1
            self.a.append(cand)
            return cand
a001597 = A001597()
for n in range(1,20):
    print(a001597.at(n)) # _R. J. Mathar_, Mar 28 2023
```
```Python
from sympy import mobius, integer_nthroot
def A001597(n):
    def f(x): return int(n-2+x+sum(mobius(k)*(integer_nthroot(x,k)[0]-1) for k in range(2,x.bit_length())))
    kmin, kmax = 1,2
    while f(kmax) >= kmax:
        kmax <<= 1
    while True:
        kmid = kmax+kmin>>1
        if f(kmid) < kmid:
            kmax = kmid
        else:
            kmin = kmid
        if kmax-kmin <= 1:
            break
    return kmax # _Chai Wah Wu_, Aug 13 2024
```
