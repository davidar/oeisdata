# Wieferich primes: primes p such that p^2 divides 2^\(p\-1\) \- 1\.
https://oeis.org/A001220
## JSON
```JSON
[1093, 3511]
```
## Maple
```Maple
wieferich := proc (n) local nsq, remain, bin, char: if (not isprime(n)) then RETURN("not prime") fi: nsq := n^2: remain := 2: bin := convert(convert(n-1, binary),string): remain := (remain * 2) mod nsq: bin := substring(bin,2..length(bin)): while (length(bin) > 1) do: char := substring(bin,1..1): if char = "1" then remain := (remain * 2) mod nsq fi: remain := (remain^2) mod nsq: bin := substring(bin,2..length(bin)): od: if (bin = "1") then remain := (remain * 2) mod nsq fi: if remain = 1 then RETURN ("Wieferich prime") fi: RETURN ("non-Wieferich prime"): end: # Ulrich Schimke (ulrschimke(AT)aol.com), Nov 01 2001
```
## Mathematica
```Mathematica
Select[Prime[Range[50000]],Divisible[2^(#-1)-1,#^2]&]  (* _Harvey P. Dale_, Apr 23 2011 *)
```
```Mathematica
Select[Prime[Range[50000]],PowerMod[2,#-1,#^2]==1&] (* _Harvey P. Dale_, May 25 2016 *)
```
## Haskell
```Haskell
import Data.List (elemIndices)
a001220 n = a001220_list !! (n-1)
a001220_list = map (a000040 . (+ 1)) $ elemIndices 1 a196202_list
-- _Reinhard Zumkeller_, Sep 29 2011
```
## PARI
```PARI
N=10^4; default(primelimit,N);
forprime(n=2,N,if(Mod(2,n^2)^(n-1)==1,print1(n,", ")));
\\ _Joerg Arndt_, May 01 2013
```
## Python
```Python
from sympy import prime
from gmpy2 import powmod
A001220_list = [p for p in (prime(n) for n in range(1,10**7)) if powmod(2,p-1,p*p) == 1]
# _Chai Wah Wu_, Dec 03 2014
```
## GAP
```GAP
Filtered([1..50000],p->IsPrime(p) and (2^(p-1)-1) mod p^2 =0); # _Muniru A Asiru_, Apr 03 2018
```
## Magma
```Magma
[p : p in PrimesUpTo(310000) | IsZero((2^(p-1) - 1) mod (p^2))]; // _Vincenzo Librandi_, Jan 19 2019
```
