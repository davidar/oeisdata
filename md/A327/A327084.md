# Array read by descending antidiagonals: A\(n,k\) is the number of unoriented colorings of the edges of a regular n\-dimensional simplex using up to k colors\.
https://oeis.org/A327084
## JSON
```JSON
[1, 2, 1, 3, 4, 1, 4, 10, 11, 1, 5, 20, 66, 34, 1, 6, 35, 276, 792, 156, 1, 7, 56, 900, 10688, 25506, 1044, 1, 8, 84, 2451, 90005, 1601952, 2302938, 12346, 1, 9, 120, 5831, 533358, 43571400, 892341888, 591901884, 274668]
```
## Mathematica
```Mathematica
CycleX[{2}] = {{1,1}}; (* cycle index for permutation with given cycle structure *)
CycleX[{n_Integer}] := CycleX[n] = If[EvenQ[n], {{n/2,1}, {n,(n-2)/2}}, {{n,(n-1)/2}}]
compress[x : {{_, _} ...}] := (s = Sort[x]; For[i = Length[s], i > 1, i -= 1, If[s[[i, 1]] == s[[i-1,1]], s[[i-1,2]] += s[[i,2]]; s = Delete[s,i], Null]]; s)
CycleX[p_List] := CycleX[p] = compress[Join[CycleX[Drop[p, -1]], If[Last[p] > 1, CycleX[{Last[p]}], ## &[]], If[# == Last[p], {#, Last[p]}, {LCM[#, Last[p]], GCD[#, Last[p]]}] & /@ Drop[p, -1]]]
pc[p_List] := Module[{ci, mb}, mb = DeleteDuplicates[p]; ci = Count[p, #] & /@ mb; Total[p]!/(Times @@ (ci!) Times @@ (mb^ci))] (* partition count *)
row[n_Integer] := row[n] = Factor[Total[pc[#] j^Total[CycleX[#]][[2]] & /@ IntegerPartitions[n+1]]/(n+1)!]
array[n_, k_] := row[n] /. j -> k
Table[array[n,d-n+1], {d,1,10}, {n,1,d}] // Flatten
(* Using Fripertinger's exponent per Andrew Howroyd code in A063841: *)
pc[p_] := Module[{ci, mb}, mb = DeleteDuplicates[p]; ci = Count[p, #] &/@ mb; Total[p]!/(Times @@ (ci!) Times @@ (mb^ci))]
ex[v_] := Sum[GCD[v[[i]], v[[j]]], {i,2,Length[v]}, {j,i-1}] + Total[Quotient[v,2]]
array[n_,k_] := Total[pc[#]k^ex[#] &/@ IntegerPartitions[n+1]]/(n+1)!
Table[array[n,d-n+1], {d,10}, {n,d}] // Flatten
(* Another program (translated from _Andrew Howroyd_'s PARI code): *)
permcount[v_] := Module[{m=1, s=0, k=0, t}, For[i=1, i <= Length[v], i++, t = v[[i]]; k = If[i>1 && t == v[[i-1]], k+1, 1]; m *= t*k; s += t]; s!/m];
edges[v_] := Sum[GCD[v[[i]], v[[j]]], {i, 2, Length[v]}, {j, 1, i-1}] + Total[Quotient[v, 2]];
T[n_, k_] := Module[{s = 0}, Do[s += permcount[p]*k^edges[p], {p, IntegerPartitions[n+1]}]; s/(n+1)!];
Table[T[n-k+1, k], {n, 1, 9}, {k, n, 1, -1}] // Flatten (* _Jean-FranÃ§ois Alcover_, Jan 08 2021 *)
```
## PARI
```PARI
permcount(v) = {my(m=1, s=0, k=0, t); for(i=1, #v, t=v[i]; k=if(i>1&&t==v[i-1], k+1, 1); m*=t*k; s+=t); s!/m}
edges(v) = {sum(i=2, #v, sum(j=1, i-1, gcd(v[i], v[j]))) + sum(i=1, #v, v[i]\2)}
T(n, k) = {my(s=0); forpart(p=n+1, s+=permcount(p)*k^edges(p)); s/(n+1)!} \\ _Andrew Howroyd_, Sep 06 2019
```
## Python
```Python
from itertools import combinations
from math import prod, gcd, factorial
from fractions import Fraction
from sympy.utilities.iterables import partitions
def A327084_T(n,k): return int(sum(Fraction(k**(sum(p[r]*p[s]*gcd(r,s) for r,s in combinations(p.keys(),2))+sum((q>>1)*r+(q*r*(r-1)>>1) for q, r in p.items())),prod(q**r*factorial(r) for q, r in p.items())) for p in partitions(n+1))) # _Chai Wah Wu_, Jul 09 2024
```
