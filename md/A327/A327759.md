# a\(1\) \= 1; a\(2\) \= 2; a\(n\) \= n \- max\{k<n \| a\(k\) \= m\(n\)\}, where m\(n\) is the largest term so far if a\(n\-1\) is odd, the second largest term so far if a\(n\-1\) is even\.
https://oeis.org/A327759
## JSON
```JSON
[1, 2, 2, 3, 1, 2, 1, 4, 5, 1, 2, 4, 1, 5, 1, 2, 5, 1, 2, 8, 4, 5, 3, 4, 3, 6, 1, 8, 3, 2, 5, 4, 7, 6, 2, 3, 9, 1, 2, 12, 4, 5, 3, 4, 8, 9, 7, 8, 3, 10, 1, 12, 3, 2, 5, 4, 7, 6, 9, 8, 11, 10, 2, 3, 13, 1, 2, 16, 4, 5, 3, 4, 8, 9, 7, 8, 12, 13, 11, 12, 3]
```
## Mathematica
```Mathematica
s={1, 2}; sm = 2; sm2 = 1; Do[a = Length[s] + 1 - If[OddQ[s[[-1]]], Position[s, _?(# == sm &)], Position[s, _?(# == sm2 &)]][[-1, 1]]; AppendTo[s, a]; If[a > sm, sm2 = sm; sm = a,If[a < sm && a > sm2, sm2 = a]], {100}]; s (* _Amiram Eldar_, Sep 28 2019 *)
```
## VBA
```VBA
Sub A327759()
Cells(1, 1) = 1
Cells(2, 1) = 2
For n = 3 To 1000
   max1 = 0
   For m = 1 To n - 1
      If Cells(m, 1) >= max1 Then
          max1 = Cells(m, 1)
          m1 = m
      End If
   Next m
   max2 = 0
   For m = 1 To n - 1
      If Cells(m, 1) <> max1 And Cells(m, 1) >= max2 Then
         max2 = Cells(m, 1)
         m2 = m
      End If
   Next m
   If Cells(n - 1, 1) Mod 2 = 1 Then
      Cells(n, 1) = n - m1
   Else
      Cells(n, 1) = n - m2
   End If
Next n
End Sub
```
## PARI
```PARI
A327759_upto(N=99, idx=[0,0], L, S, a)=vector(N,n,a=n-if(n>2,idx[2-a%2]); L<a && [S,idx[2]]=[L,idx[1]]; if(L<=a, L=a; idx[1]=n, S<=a, S=a; idx[2]=n); a) \\ _M. F. Hasler_, Sep 29 2019
```
```PARI
A327759(n)={my(r=sqrtint(abs(n-2))+1,c=n-(r-1)^2-1); if(n<17, digits(1223121451241512)[n], c==1, 1, c==2*r-2, 3,c==2*r-1, 2*r-3-r%2, r%2, if(c==3, 2*r-2, c>2, c\4*4+[0,1,-1,0][c-c\4*4+1], 2), c==2, 2*r-4, c<2*r-3, c\/2*2+(c%2)-2,2)} \\ _M. F. Hasler_, Sep 30 2019
```
## Python
```Python
def A327759list(nmax):
    A = [1,2]
    for n in range(3,nmax+1):
        if A[-1]%2 == 0:
            A2 = list(set(A))
            A2.sort()
            m = A2[-2]
        else: m = max(A)
        i = len(A) - 1
        while A[i] != m: i -= 1
        A.append(n-i-1)
    print(A) # _John Tyler Rascoe_, Jan 13 2023
```
