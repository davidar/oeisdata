# Number of ordered triples of integers from \[ 1\.\.n \] with no global factor\.
https://oeis.org/A015631
## JSON
```JSON
[1, 3, 8, 15, 29, 42, 69, 95, 134, 172, 237, 287, 377, 452, 552, 652, 804, 915, 1104, 1252, 1450, 1635, 1910, 2106, 2416, 2674, 3007, 3301, 3735, 4027, 4522, 4914, 5404, 5844, 6432, 6870, 7572, 8121, 8805, 9389, 10249, 10831, 11776, 12506]
```
## Maple
```Maple
with(numtheory):
b:= proc(n) option remember;
       add(mobius(n/d)*d*(d+1)/2, d=divisors(n))
    end:
a:= proc(n) option remember;
      b(n) + `if`(n=1, 0, a(n-1))
    end:
seq(a(n), n=1..60);  # _Alois P. Heinz_, Feb 09 2011
```
## Mathematica
```Mathematica
a[1] = 1; a[n_] := a[n] = Sum[MoebiusMu[n/d]*d*(d+1)/2, {d, Divisors[n]}] + a[n-1]; Table[a[n], {n, 1, 60}] (* _Jean-FranÃ§ois Alcover_, Jan 20 2014, after Maple *)
```
```Mathematica
Accumulate[Table[Sum[MoebiusMu[n/d]*d*(d + 1)/2, {d, Divisors[n]}], {n, 1, 50}]] (* _Vaclav Kotesovec_, Jan 31 2019 *)
```
## Magma
```Magma
[n eq 1 select 1 else Self(n-1)+ &+[MoebiusMu(n div d) *d*(d+1)/2:d in Divisors(n)]:n in [1..50]]; // _Marius A. Burtea_, Feb 14 2020
```
## Python
```Python
from functools import lru_cache
@lru_cache(maxsize=None)
def A015631(n):
    if n == 0:
        return 0
    c, j = 1, 2
    k1 = n//j
    while k1 > 1:
        j2 = n//k1 + 1
        c += (j2-j)*A015631(k1)
        j, k1 = j2, n//j2
    return n*(n-1)*(n+4)//6-c+j # _Chai Wah Wu_, Mar 30 2021
```
## PARI
```PARI
a(n) = sum(k=1, n, sumdiv(k, d, moebius(k/d)*binomial(d+1, 2))); \\ _Seiichi Manyama_, Jun 12 2021
```
```PARI
a(n) = binomial(n+2, 3)-sum(k=2, n, a(n\k)); \\ _Seiichi Manyama_, Jun 12 2021
```
```PARI
my(N=66, x='x+O('x^N)); Vec(sum(k=1, N, moebius(k)*x^k/(1-x^k)^3)/(1-x)) \\ _Seiichi Manyama_, Jun 12 2021
```
