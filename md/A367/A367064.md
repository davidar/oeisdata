# Determinant of the matrix d\*e/gcd\(d, e\)^2, where d, e run through the unitary divisors of n\.
https://oeis.org/A367064
## JSON
```JSON
[1, -3, -8, -15, -24, 576, -48, -63, -80, 5184, -120, 14400, -168, 20736, 36864, -255, -288, 57600, -360, 129600, 147456, 129600, -528, 254016, -624, 254016, -728, 518400, -840, 110075314176, -960, -1023, 921600, 746496, 1327104, 1440000, -1368, 1166400, 1806336, 2286144, -1680, 1761205026816, -1848]
```
## Sage
```Sage
def unitary_divisors(n):
    return [d for d in divisors(n) if gcd(n//d, d) == 1]
def Un(n):
    un = unitary_divisors(n)
    M = matrix([[a*b//gcd(a,b)**2 for a in un] for b in un])
    return M.det()
print([Un(n) for n in range(1, 44)])
# Alternative:
def detN(n):
    PD = set(prime_divisors(n))
    Sn = Subsets(PD)
    dn = 1
    for si in Sn:
        sj = PD.difference(si)
        Pi = prod(1 + p**valuation(n, p) for p in si)
        Pj = prod(1 - p**valuation(n, p) for p in sj)
        dn = dn*Pi*Pj
    return dn
print([detN(n) for n in range(1, 44)])
# Based on the extensions found by David A. Corneth and Chai Wah Wu:
def uphi(n):
    return prod(p**(valuation(n,p))-1 for p in prime_divisors(n))
def usigma(n):
    return sum(d for d in divisors(n) if gcd(n//d, d) == 1)
def omega(n):
    return len(prime_divisors(n))
def ddet(n):
    return (uphi(n)*usigma(n))**(2**(omega(n)-1))*(-1)**(omega(n))
print([ddet(n) for n in range(1, 44)])
```
## PARI
```PARI
a(n) = {
        my(d = divisors(n), m);
	d = select(x->gcd(x, n/x)==1, d);
	m = matrix(#d, #d, i, j, d[i]*d[j]/(gcd(d[i], d[j])^2));
	matdet(m)
} \\ _David A. Corneth_, Nov 04 2023
```
```PARI
a(n) = {
	my(f = factor(n), P = vector(#f~, i, f[i,1]^(2*f[i,2])), res = 1);
	forsubset(#f~, s,
		s = Set(s);
		vs = vector(#s, i, 1 - P[s[i]]);
		res*=vecprod(vs);
	);
	return(res);
} \\ _David A. Corneth_, Nov 04 2023
```
## Python
```Python
from math import prod
from sympy import factorint
def A367064(n):
    f = factorint(n)
    return prod(1-d**(e<<1) for d,e in f.items())**(1<<len(f)-1) if n>1 else 1
# _Chai Wah Wu_, Nov 06 2023
```
