# Trace of addition table of group of divisors of n\.
https://oeis.org/A367197
## JSON
```JSON
[1, 2, 2, 7, 2, 4, 2, 10, 13, 4, 2, 14, 2, 4, 4, 31, 2, 26, 2, 14, 4, 4, 2, 20, 31, 4, 20, 14, 2, 8, 2, 42, 4, 4, 4, 91, 2, 4, 4, 20, 2, 8, 2, 14, 26, 4, 2, 62, 57, 62, 4, 14, 2, 40, 4, 20, 4, 4, 2, 28, 2, 4, 26, 127, 4, 8, 2, 14, 4, 8, 2, 130, 2, 4, 62, 14, 4, 8, 2, 62, 121, 4, 2, 28]
```
## Mathematica
```Mathematica
f[p_, e_] := If[EvenQ[e], (p^(e + 1) - 1)/(p - 1), 2*(p^(e + 1) - 1)/(p^2 - 1)]; a[1] = 1; a[n_] := Times @@ f @@@ FactorInteger[n]; Array[a, 100] (* _Amiram Eldar_, Nov 22 2023 *)
```
## Sage
```Sage
def a(n):
    return sigma(n)*prod((p**valuation(n,p)+p**(2*floor(valuation(n,p)/2)+1))/(p**valuation(n,p)*(p+1)) for p in prime_divisors(n))
```
## PARI
```PARI
b(n,d) = my(f=factor(n)); prod(k=1,#f~, if(2*valuation(d,f[k,1])>=valuation(n,f[k,1])+1,{f[k,1]^(valuation(n,f[k,1])+1)},{1}));
a(n) = my(d=divisors(n)); sumdiv(n, d, d^2/b(n,d));
```
```PARI
a(n)=my(f=factor(n)); sigma(n)*prod(k=1,#f~, (f[k,1]^valuation(n,f[k,1])+f[k,1]^(2*floor(valuation(n,f[k,1])/2)+1))/(f[k,1]^valuation(n,f[k,1])*(f[k,1]+1) ));
```
```PARI
a(n) = my(d=divisors(n), f=factor(n), m=matrix(#d, #d, i, j, prod(k=1, #f~, f[k,1]^((valuation(d[i],f[k,1])+valuation(d[j],f[k,1])) % (1+f[k,2]))))); trace(m); \\ _Michel Marcus_, Nov 10 2023
```
## Python
```Python
from math import prod
from sympy import factorint
def A367197(n): return prod((p**(e+1)-1<<1)//(p**2-1) if e&1 else (p**(e+1)-1)//(p-1) for p,e in factorint(n).items()) # _Chai Wah Wu_, Nov 19 2023
```
