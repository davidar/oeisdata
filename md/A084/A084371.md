# Squarefree kernels of powerful numbers \(A001694\)\.
https://oeis.org/A084371
## JSON
```JSON
[1, 2, 2, 3, 2, 5, 3, 2, 6, 7, 2, 6, 3, 10, 6, 11, 5, 2, 6, 13, 14, 10, 6, 15, 3, 2, 6, 17, 6, 7, 19, 14, 10, 6, 21, 22, 10, 2, 23, 6, 5, 6, 15, 26, 3, 14, 10, 29, 6, 30, 31, 22, 6, 10, 2, 33, 15, 6, 34, 35, 6, 21, 11, 26, 37, 14, 38, 39, 14, 10, 41, 6, 42, 30, 43, 22, 6, 10]
```
## Mathematica
```Mathematica
s = {1}; Do[f = FactorInteger[n]; If[Min @ f[[;;, 2]] > 1, AppendTo[s, Times @@ f[[;;, 1]]]], {n, 2, 10^4}]; s (* _Amiram Eldar_, Aug 22 2019 *)
```
## PARI
```PARI
rad(n) = factorback(factorint(n)[, 1]); \\ A007947
lista(nn) = apply(x->rad(x), select(x->ispowerful(x), [1..nn])); \\ _Michel Marcus_, Aug 22 2019
```
## Python
```Python
from math import prod, isqrt
from sympy import mobius, integer_nthroot, primefactors
def A084371(n):
    def squarefreepi(n): return int(sum(mobius(k)*(n//k**2) for k in range(1, isqrt(n)+1)))
    def bisection(f,kmin=0,kmax=1):
        while f(kmax) > kmax: kmax <<= 1
        while kmax-kmin > 1:
            kmid = kmax+kmin>>1
            if f(kmid) <= kmid:
                kmax = kmid
            else:
                kmin = kmid
        return kmax
    def f(x):
        c, l, j = n+x-squarefreepi(integer_nthroot(x,3)[0]), 0, isqrt(x)
        while j>1:
            k2 = integer_nthroot(x//j**2,3)[0]+1
            w = squarefreepi(k2-1)
            c -= j*(w-l)
            l, j = w, isqrt(x//k2**3)
        return c+l
    return prod(primefactors(bisection(f,n,n))) # _Chai Wah Wu_, Sep 13 2024
```
