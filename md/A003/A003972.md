# Moebius transform of A003961; a\(n\) \= phi\(A003961\(n\)\), where A003961 shifts the prime factorization of n one step towards the larger primes\.
https://oeis.org/A003972
## JSON
```JSON
[1, 2, 4, 6, 6, 8, 10, 18, 20, 12, 12, 24, 16, 20, 24, 54, 18, 40, 22, 36, 40, 24, 28, 72, 42, 32, 100, 60, 30, 48, 36, 162, 48, 36, 60, 120, 40, 44, 64, 108, 42, 80, 46, 72, 120, 56, 52, 216, 110, 84, 72, 96, 58, 200, 72, 180, 88, 60, 60, 144, 66, 72, 200, 486, 96, 96, 70]
```
## Mathematica
```Mathematica
b[1] = 1; b[p_?PrimeQ] := b[p] = Prime[ PrimePi[p] + 1]; b[n_] := b[n] = Times @@ (b[First[#]]^Last[#] &) /@ FactorInteger[n]; a[n_] := Sum[ MoebiusMu[n/d]*b[d], {d, Divisors[n]}]; Table[a[n], {n, 1, 70}]  (* _Jean-Fran√ßois Alcover_, Jul 18 2013 *)
```
## PARI
```PARI
A003972(n) = { my(f = factor(n)); for (i=1, #f~, f[i, 1] = nextprime(f[i, 1]+1)); eulerphi(factorback(f)); }; \\ _Antti Karttunen_, Aug 20 2020
```
## Python
```Python
from math import prod
from sympy import nextprime, factorint
def A003972(n): return prod((q:=nextprime(p))**(e-1)*(q-1) for p, e in factorint(n).items()) # _Chai Wah Wu_, Jul 18 2022
```
