# Kimberling's paraphrases: if n \= \(2k\-1\)\*2^m then a\(n\) \= k\.
https://oeis.org/A003602
## JSON
```JSON
[1, 1, 2, 1, 3, 2, 4, 1, 5, 3, 6, 2, 7, 4, 8, 1, 9, 5, 10, 3, 11, 6, 12, 2, 13, 7, 14, 4, 15, 8, 16, 1, 17, 9, 18, 5, 19, 10, 20, 3, 21, 11, 22, 6, 23, 12, 24, 2, 25, 13, 26, 7, 27, 14, 28, 4, 29, 15, 30, 8, 31, 16, 32, 1, 33, 17, 34, 9, 35, 18, 36, 5, 37, 19, 38, 10, 39, 20, 40, 3, 41, 21, 42]
```
## Maple
```Maple
A003602:=proc(n) options remember: if n mod 2 = 1 then RETURN((n+1)/2) else RETURN(procname(n/2)) fi: end proc:
seq(A003602(n), n=1..83); # Pab Ter
nmax := 83: for m from 0 to ceil(simplify(log[2](nmax))) do for k from 1 to ceil(nmax/(m+2)) do a((2*k-1)*2^m) := k od: od: seq(a(k), k=1..nmax); # _Johannes W. Meijer_, Feb 04 2013
A003602 := proc(n)
    a := 1;
    for p in ifactors(n)[2] do
        if op(1,p) > 2 then
            a := a*op(1,p)^op(2,p) ;
        end if;
    end do  :
    (a+1)/2 ;
end proc: # _R. J. Mathar_, May 19 2016
```
## Mathematica
```Mathematica
a[n_] := Block[{m = n}, While[ EvenQ@m, m /= 2]; (m + 1)/2]; Array[a, 84] (* or *)
```
```Mathematica
a[1] = 1; a[n_] := a[n] = If[OddQ@n, (n + 1)/2, a[n/2]]; Array[a, 84] (* _Robert G. Wilson v_, May 23 2006 *)
```
```Mathematica
a[n_] := Ceiling[NestWhile[Floor[#/2] &, n, EvenQ]/2]; Array[a, 84] (* _Birkas Gyorgy_, Apr 05 2011 *)
```
```Mathematica
a003602 = {1}; max = 7; Do[b = {}; Do[AppendTo[b, {k, a003602[[k]]}], {k, Length[a003602]}]; a003602 = Flatten[b], {n, 2, max}]; a003602 (* _L. Edson Jeffery_, Nov 21 2015 *)
```
## PARI
```PARI
A003602(n)=(n/2^valuation(n,2)+1)/2; /* _Joerg Arndt_, Apr 06 2011 */
```
## Haskell
```Haskell
a003602 = (`div` 2) . (+ 1) . a000265
-- _Reinhard Zumkeller_, Feb 16 2012, Oct 14 2010
```
```Haskell
import Data.List (transpose)
a003602 = flip div 2 . (+ 1) . a000265
a003602_list = concat $ transpose [[1..], a003602_list]
-- _Reinhard Zumkeller_, Aug 09 2013, May 23 2013
```
## Scheme
```Scheme
(define (A003602 n) (let loop ((n n)) (if (even? n) (loop (/ n 2)) (/ (+ 1 n) 2)))) ;; _Antti Karttunen_, Feb 04 2015
```
## Python
```Python
import math
def a(n): return (n/2**int(math.log(n - (n & n - 1), 2)) + 1)/2 # _Indranil Ghosh_, Apr 24 2017
```
```Python
def A003602(n): return (n>>(n&-n).bit_length())+1 # _Chai Wah Wu_, Jul 08 2022
```
