# Ternary Thue\-Morse sequence: closed under a\-\>abc, b\-\>ac, c\-\>b\.
https://oeis.org/A036585
## JSON
```JSON
[3, 2, 1, 3, 1, 2, 3, 2, 1, 2, 3, 1, 3, 2, 1, 3, 1, 2, 3, 1, 3, 2, 1, 2, 3, 2, 1, 3, 1, 2, 3, 2, 1, 2, 3, 1, 3, 2, 1, 2, 3, 2, 1, 3, 1, 2, 3, 1, 3, 2, 1, 3, 1, 2, 3, 2, 1, 2, 3, 1, 3, 2, 1, 3, 1, 2, 3, 1, 3, 2, 1, 2, 3, 2, 1, 3, 1, 2, 3, 1, 3, 2, 1, 3, 1, 2, 3, 2, 1, 2, 3, 1, 3, 2, 1, 2, 3, 2, 1, 3, 1, 2, 3, 2, 1]
```
## PARI
```PARI
a(n)=if(n<1 || valuation(n,2)%2,2,2-(-1)^subst(Pol(binary(n)),x,1))
```
## Haskell
```Haskell
a036585 n = a036585_list !! (n-1)
a036585_list = 3 : concat (map f a036585_list)
where f 1 = [1,2,3]; f 2 = [1,3]; f 3 = [2]
-- _Reinhard Zumkeller_, Oct 31 2012
```
## Python
```Python
def A036585(n): return 2+(n.bit_count()&1)-((n-1).bit_count()&1) # _Chai Wah Wu_, Mar 03 2023
```
