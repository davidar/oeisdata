# Ternary Thue\-Morse sequence: closed under a\-\>abc, b\-\>ac, c\-\>b\.
https://oeis.org/A036577
## JSON
```JSON
[2, 1, 0, 2, 0, 1, 2, 1, 0, 1, 2, 0, 2, 1, 0, 2, 0, 1, 2, 0, 2, 1, 0, 1, 2, 1, 0, 2, 0, 1, 2, 1, 0, 1, 2, 0, 2, 1, 0, 1, 2, 1, 0, 2, 0, 1, 2, 0, 2, 1, 0, 2, 0, 1, 2, 1, 0, 1, 2, 0, 2, 1, 0, 2, 0, 1, 2, 0, 2, 1, 0, 1, 2, 1, 0, 2, 0, 1, 2, 0, 2, 1, 0, 2, 0, 1, 2, 1, 0, 1, 2, 0, 2, 1, 0, 1, 2, 1, 0, 2, 0, 1, 2, 1, 0]
```
## Mathematica
```Mathematica
(* ThueMorse is built-in since version 10.2, for lower versions it needs to be defined manually *) ThueMorse[n_] := Mod[DigitCount[n, 2, 1], 2]; Table[1 + ThueMorse[n] - ThueMorse[n-1], {n, 1, 100}]  (* _Vladimir Reshetnikov_, May 17 2016 *)
```
```Mathematica
Nest[Flatten[# /. {2 -> {2, 1, 0}, 1 -> {2, 0}, 0 -> {1}}] &, {2, 1, 0}, 7] (* _Robert G. Wilson v_, Jul 30 2018 *)
```
## PARI
```PARI
{a(n) = if( n<1, 0, if( valuation( n, 2)%2, 1, 1 - (-1)^subst( Pol( binary(n)), x, 1)))} /* _Michael Somos_, Aug 03 2011 */
```
## Python
```Python
def A036577(n): return (n.bit_count()&1)+((n-1).bit_count()&1^1) # _Chai Wah Wu_, Mar 03 2023
```
