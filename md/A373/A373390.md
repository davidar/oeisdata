# a\(n\) \= n for n <\= 3; for n \> 3, a\(n\) is the smallest unused positive number that is coprime to a\(n\-1\) but has a common factor with at least one of a\(1\)\.\.\.a\(n\-2\)\.
https://oeis.org/A373390
## JSON
```JSON
[1, 2, 3, 4, 9, 8, 15, 14, 5, 6, 7, 10, 21, 16, 25, 12, 35, 18, 49, 20, 27, 22, 39, 11, 13, 24, 55, 26, 33, 28, 45, 32, 51, 38, 17, 19, 30, 77, 34, 57, 40, 63, 44, 65, 36, 85, 42, 95, 46, 75, 23, 48, 91, 50, 69, 52, 81, 56, 87, 62, 29, 31, 54, 115, 58, 93, 64, 99, 68, 105, 74, 117, 37, 60, 119, 66]
```
## Mathematica
```Mathematica
c[_] := False; p[_] := False; nn = 120;
```
```Mathematica
Array[Set[{a[#], c[#], p[#]}, {#, True, True}] &, 3];
```
```Mathematica
i = a[2]; j = a[3]; u = 4;
```
```Mathematica
Do[k = u;
```
```Mathematica
 While[Or[c[k], ! CoprimeQ[j, k],
```
```Mathematica
   NoneTrue[Set[s, #], p] &@FactorInteger[k][[All, 1]]], k++];
```
```Mathematica
 Map[Set[p[#], True] &, s];
```
```Mathematica
 Set[{a[n], c[k], i, j}, {k, True, j, k}];
```
```Mathematica
 If[k == u, While[c[u], u++]], {n, 4, nn}];
```
```Mathematica
Array[a, nn] (* _Michael De Vlieger_, Jun 06 2024 *)
```
## Python
```Python
from math import gcd, lcm
from itertools import count, islice
def agen(): # generator of terms
    yield from [1, 2, 3]
    aset, an, LCM, mink = {1, 2, 3}, 3, 6, 4
    while True:
        an = next(k for k in count(mink) if k not in aset and gcd(k, an) == 1 and gcd(k, LCM) > 1)
        LCM = lcm(LCM, an)
        aset.add(an)
        while mink in aset: mink += 1
        yield an
print(list(islice(agen(), 76))) # _Michael S. Branicky_, Jun 18 2024
```
