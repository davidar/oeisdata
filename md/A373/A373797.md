# a\(n\) \= maximal k such that there exists a sequence S \= \[s\_1, s\_2, \.\.\., s\_k\] with s\_i distinct and in the range 1 <\= s\_i <\= n such that if any s\_i is divisible by a prime p, then p also divides exactly one of s\_\{i\-1\} and s\_\{i\+1\}\.
https://oeis.org/A373797
## JSON
```JSON
[1, 1, 1, 3, 3, 4, 4, 6, 6, 8, 8, 10, 10, 11, 11, 13, 13, 14, 14, 16, 16, 17, 17, 19, 19, 21, 22, 24, 24, 25, 25]
```
## Python
```Python
from itertools import permutations
from sympy import primefactors, primepi
def A373797(n):
    c = [set()]+[set(primefactors(i)) for i in range(1,n+1)]+[set()]
    for k in range(n-primepi(n)+primepi(n>>1),0,-1):
        for a in permutations(range(1,n+1),k):
            alist = [0]+list(a)+[n+1]
            if all((p in c[alist[i-1]])^(p in c[alist[i+1]]) for i, d in enumerate(alist[1:-1],1) for p in c[d]):
                return k # _Chai Wah Wu_, Jul 26 2024
```
```Python
# Given a list S = [s_1, s_2, ..., s_k], this function checks if the terms s_i are such that if any s_i is divisible by a prime p, then p also divides exactly one of s_{i-1} and s_{i+1}.
from sympy import primefactors
def isSolution(S: list[int]) -> bool:
    return all(not any((S[i-1] % p == 0) == (S[i+1] % p == 0)
           for p in primefactors(S[i])) for i in range(1, len(S)-1))
# _Peter Luschny_, Jul 27 2024
```
