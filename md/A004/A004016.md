# Theta series of planar hexagonal lattice A\_2\.
https://oeis.org/A004016
## JSON
```JSON
[1, 6, 0, 6, 6, 0, 0, 12, 0, 6, 0, 0, 6, 12, 0, 0, 6, 0, 0, 12, 0, 12, 0, 0, 0, 6, 0, 6, 12, 0, 0, 12, 0, 0, 0, 0, 6, 12, 0, 12, 0, 0, 0, 12, 0, 0, 0, 0, 6, 18, 0, 0, 12, 0, 0, 0, 0, 12, 0, 0, 0, 12, 0, 12, 6, 0, 0, 12, 0, 0, 0, 0, 0, 12, 0, 6, 12, 0, 0, 12, 0]
```
## Maple
```Maple
A004016 := proc(n)
    local a,j ;
    a := A033716(n) ;
    for j from 0 to n/3 do
        a := a+A089800(n-1-3*j)*A089800(j) ;
    end do:
    a;
end proc:
seq(A004016(n),n=0..49) ; # _R. J. Mathar_, Feb 22 2021
```
## Mathematica
```Mathematica
a[ n_] := If[ n < 1, Boole[ n == 0 ], 6 DivisorSum[ n, KroneckerSymbol[ #, 3] &]]; (* _Michael Somos_, Nov 08 2011 *)
```
```Mathematica
a[ n_] := SeriesCoefficient[ (QPochhammer[ q]^3 + 9 q QPochhammer[ q^9]^3) / QPochhammer[ q^3], {q, 0, n}]; (* _Michael Somos_, Nov 13 2014 *)
```
```Mathematica
a[ n_] := SeriesCoefficient[ EllipticTheta[ 3, 0, q] EllipticTheta[ 3, 0, q^3] + EllipticTheta[ 2, 0, q] EllipticTheta[ 2, 0, q^3], {q, 0, n}]; (* _Michael Somos_, Nov 13 2014 *)
```
```Mathematica
a[ n_] := Length @ FindInstance[ x^2 + x y + y^2 == n, {x, y}, Integers, 10^9]; (* _Michael Somos_, Sep 14 2015 *)
```
```Mathematica
terms = 81; f[q_] = LatticeData["A2", "ThetaSeriesFunction"][-I Log[q]/Pi]; s = Series[f[q], {q, 0, 2 terms}]; CoefficientList[s, q^2][[1 ;; terms]] (* _Jean-FranÃ§ois Alcover_, Jul 04 2017 *)
```
## PARI
```PARI
{a(n) = my(A, p, e); if( n<1, n==0, A = factor(n); 6 * prod( k=1, matsize(A)[1], [p, e] = A[k, ]; if( p==3, 1, p%3==1, e+1, 1-e%2)))}; /* _Michael Somos_, May 20 2005 */ /* Editor's note: this is the most efficient program */
```
```PARI
{a(n) = if( n<0, 0, polcoeff( 1 + 6 * sum( k=1,n, x^k / (1 + x^k + x^(2*k)), x * O(x^n)), n))}; /* _Michael Somos_, Oct 06 2003 */
```
```PARI
{a(n) = if( n<1, n==0, 6 * sumdiv( n,d, kronecker( d, 3)))}; /* _Michael Somos_, Mar 16 2005 */
```
```PARI
{a(n) = if( n<1, n==0, 6 * sumdiv( n,d, (d%3==1) - (d%3==2)))}; /* _Michael Somos_, May 20 2005 */
```
```PARI
{a(n) = my(A); if( n<0, 0, n*=3; A = x * O(x^n); polcoeff( (eta(x + A)^3  + 3 * x * eta(x^9 + A)^3) / eta(x^3 + A), n))}; /* _Michael Somos_, May 20 2005 */
```
```PARI
{a(n) = if( n<1, n==0, qfrep([ 2, 1; 1, 2], n, 1)[n] * 2)}; /* _Michael Somos_, Jul 16 2005 */
```
```PARI
{a(n) = if( n<0, 0, polcoeff( 1 + 6 * sum( k=1, n, x^(3*k - 2) / (1 - x^(3*k - 2)) - x^(3*k - 1) / (1 - x^(3*k - 1)), x * O(x^n)), n))} /* _Paul D. Hanna_, Jul 03 2011 */
```
## Sage
```Sage
ModularForms( Gamma1(3), 1, prec=81).0 ; # _Michael Somos_, Jun 04 2013
```
## Magma
```Magma
Basis( ModularForms( Gamma1(3), 1), 81) [1]; /* _Michael Somos_, May 27 2014 */
```
```Magma
L := Lattice("A",2); A<q> := ThetaSeries(L, 161); A; /* _Michael Somos_, Nov 13 2014 */
```
## Python
```Python
from math import prod
from sympy import factorint
def A004016(n): return 6*prod(e+1 if p%3==1 else int(not e&1) for p, e in factorint(n).items() if p != 3) if n else 1 # _Chai Wah Wu_, Nov 17 2022
```
