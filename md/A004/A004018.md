# Theta series of square lattice \(or number of ways of writing n as a sum of 2 squares\)\. Often denoted by r\(n\) or r\_2\(n\)\.
https://oeis.org/A004018
## JSON
```JSON
[1, 4, 4, 0, 4, 8, 0, 0, 4, 4, 8, 0, 0, 8, 0, 0, 4, 8, 4, 0, 8, 0, 0, 0, 0, 12, 8, 0, 0, 8, 0, 0, 4, 0, 8, 0, 4, 8, 0, 0, 8, 8, 0, 0, 0, 8, 0, 0, 0, 4, 12, 0, 8, 8, 0, 0, 0, 0, 8, 0, 0, 8, 0, 0, 4, 16, 0, 0, 8, 0, 0, 0, 4, 8, 8, 0, 0, 0, 0, 0, 8, 4, 8, 0, 0, 16, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0, 0, 8, 4, 0, 12, 8]
```
## Maple
```Maple
(sum(x^(m^2),m=-10..10))^2;
# Alternative:
A004018list := proc(len) series(JacobiTheta3(0, x)^2, x, len+1);
seq(coeff(%, x, j), j=0..len-1) end:
t1 := A004018list(102);
r2 := n -> t1[n+1]; # _Peter Luschny_, Oct 02 2018
```
## Mathematica
```Mathematica
SquaresR[2,Range[0,110]] (* _Harvey P. Dale_, Oct 10 2011 *)
```
```Mathematica
a[ n_] := SquaresR[ 2, n]; (* _Michael Somos_, Nov 15 2011 *)
```
```Mathematica
a[ n_] := SeriesCoefficient[ EllipticTheta[ 3, 0, q]^2, {q, 0, n}]; (* _Michael Somos_, Nov 15 2011 *)
```
```Mathematica
a[ n_] := With[{m = InverseEllipticNomeQ @ q}, SeriesCoefficient[ EllipticK[ m] / (Pi/2), {q, 0, n}]]; (* _Michael Somos_, Jun 10 2014 *)
```
```Mathematica
a[ n_] := If[ n < 1, Boole[n == 0], 4 Sum[ KroneckerSymbol[-4, d], {d, Divisors@n}]]; (* or *) a[ n_] := SeriesCoefficient[ QPochhammer[ q^2]^10/(QPochhammer[ q] QPochhammer[ q^4])^4, {q, 0, n}]; (* _Michael Somos_, May 17 2015 *)
```
## PARI
```PARI
{a(n) = polcoeff( 1 + 4 * sum( k=1, n, x^k / (1 + x^(2*k)), x * O(x^n)), n)}; /* _Michael Somos_, Mar 14 2003 */
```
```PARI
{a(n) = if( n<1, n==0, 4 * sumdiv( n, d, (d%4==1) - (d%4==3)))}; /* _Michael Somos_, Jul 19 2004 */
```
```PARI
{a(n) = if( n<1, n==0, 2 * qfrep([ 1, 0; 0, 1], n)[n])}; /* _Michael Somos_, May 13 2005 */
```
```PARI
a(n)=if(n==0,return(1)); my(f=factor(n)); 4*prod(i=1,#f~, if(f[i,1]%4==1, f[i,2]+1, if(f[i,2]%2 && f[i,1]>2, 0, 1))) \\ _Charles R Greathouse IV_, Sep 02 2015
```
## Magma
```Magma
Basis( ModularForms( Gamma1(4), 1), 100) [1]; /* _Michael Somos_, Jun 10 2014 */
```
## Sage
```Sage
Q = DiagonalQuadraticForm(ZZ, [1]*2)
Q.representation_number_list(102) # _Peter Luschny_, Jun 20 2014
```
## Julia
```Julia
# JacobiTheta3 is defined in A000122.
A004018List(len) = JacobiTheta3(len, 2)
A004018List(102) |> println # _Peter Luschny_, Mar 12 2018
```
## Python
```Python
from sympy import factorint
def a(n):
    if n == 0: return 1
    an = 4
    for pi, ei in factorint(n).items():
       if pi%4 == 1: an *= ei+1
       elif pi%4 == 3 and ei%2: return 0
    return an
print([a(n) for n in range(102)]) # _Michael S. Branicky_, Sep 24 2021
```
```Python
from math import prod
from sympy import factorint
def A004018(n): return prod(1 if p==2 else (e+1 if p&3==1 else (e+1)&1) for p, e in factorint(n).items())<<2 if n else 1 # _Chai Wah Wu_, Jul 07 2022, corrected Jun 21 2024.
```
