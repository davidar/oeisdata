# Largest integer k < n such that any prime factor of k is also a prime factor of n\.
https://oeis.org/A079277
## JSON
```JSON
[1, 1, 2, 1, 4, 1, 4, 3, 8, 1, 9, 1, 8, 9, 8, 1, 16, 1, 16, 9, 16, 1, 18, 5, 16, 9, 16, 1, 27, 1, 16, 27, 32, 25, 32, 1, 32, 27, 32, 1, 36, 1, 32, 27, 32, 1, 36, 7, 40, 27, 32, 1, 48, 25, 49, 27, 32, 1, 54, 1, 32, 49, 32, 25, 64, 1, 64, 27, 64, 1, 64, 1, 64, 45, 64, 49, 72, 1, 64, 27]
```
## Mathematica
```Mathematica
Table[If[n == 2, 1, Module[{k = n - 2, e = Floor@ Log2@ n}, While[PowerMod[n, e, k] != 0, k--]; k]], {n, 2, 81}] (* _Michael De Vlieger_, Apr 26 2017 *)
```
## PARI
```PARI
a(n) = {forstep(k = n - 1, 2, -1, f = factor(k); okk = 1; for (i=1, #f~, if ((n % f[i,1]) != 0, okk = 0; break;)); if (okk, return (k));); return (1);} \\ _Michel Marcus_, Jun 11 2013
```
```PARI
A007947(n) = factorback(factorint(n)[, 1]); \\ _Andrew Lelechenko_, May 09 2014
A079277(n) = { my(r); if((n > 1 && !bitand(n,(n-1))), (n/2), r=A007947(n); if(1==n,0,k = n-1; while(A007947(k*n) <> r, k = k-1); k)); }; \\ _Antti Karttunen_, Apr 26 2017
```
## Python
```Python
from sympy import divisors
from sympy.ntheory.factor_ import core
def a007947(n): return max(d for d in divisors(n) if core(d) == d)
def a(n):
    k=n - 1
    while True:
        if a007947(k*n) == a007947(n): return k
        else: k-=1
print([a(n) for n in range(2, 101)]) # _Indranil Ghosh_, Apr 26 2017
```
