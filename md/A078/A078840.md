# Table of n\-almost\-primes T\(n,k\) \(n \>\= 0, k \> 0\), read by antidiagonals, starting at T\(0,1\)\=1 followed by T\(1,1\)\=2\.
https://oeis.org/A078840
## JSON
```JSON
[1, 2, 3, 4, 5, 6, 8, 7, 9, 12, 16, 11, 10, 18, 24, 32, 13, 14, 20, 36, 48, 64, 17, 15, 27, 40, 72, 96, 128, 19, 21, 28, 54, 80, 144, 192, 256, 23, 22, 30, 56, 108, 160, 288, 384, 512, 29, 25, 42, 60, 112, 216, 320, 576, 768, 1024, 31, 26, 44, 81, 120, 224, 432, 640, 1152]
```
## Mathematica
```Mathematica
AlmostPrimePi[k_Integer, n_] := Module[{a, i}, a[0] = 1; If[k == 1, PrimePi[n], Sum[PrimePi[n/Times @@ Prime[ Array[a, k - 1]]] - a[k - 1] + 1, Evaluate[ Sequence @@ Table[{a[i], a[i - 1], PrimePi[(n/Times @@ Prime[Array[a, i - 1]])^(1/(k - i + 1))]}, {i, k - 1}]] ]]]; (* _Eric W. Weisstein_, Feb 07 2006 *)
```
```Mathematica
AlmostPrime[k_, n_] := Block[{e = Floor[Log[2, n]+k], a, b}, a = 2^e; Do[b = 2^p; While[ AlmostPrimePi[k, a] < n, a = a + b]; a = a - b/2, {p, e, 0, -1}]; a + b/2]; Table[ AlmostPrime[k, n - k + 1], {n, 11}, {k, n}] // Flatten (* _Robert G. Wilson v_ *)
```
```Mathematica
mx = 11; arr = NestList[Take[Union@Flatten@Outer[Times, #, primes], mx] &, primes = Prime@Range@mx, mx]; Prepend[Flatten@Table[arr[[k, n - k + 1]], {n, mx}, {k, n}], 1] (* _Ivan Neretin_, Apr 30 2016 *)
```
```Mathematica
(* The next code skips the initial 1. *)
```
```Mathematica
width = 15; (seq = Table[
```
```Mathematica
  Rest[NestList[1 + NestWhile[# + 1 &, #, ! PrimeOmega[#] == z &] &,
```
```Mathematica
  2^z, width - z + 1]] - 1, {z, width}]) // TableForm
```
```Mathematica
Flatten[Map[Reverse[Diagonal[Reverse[seq], -width + #]] &, Range[width]]]
```
```Mathematica
(* _Peter J. C. Moses_, Jun 05 2019 *)
```
## PARI
```PARI
T(n,k)=if(k<0,0,s=1; while(sum(i=1,s,if(bigomega(i)-n,0,1))<k,s++); s)
```
## Python
```Python
from math import prod, isqrt
from sympy import primerange, integer_nthroot, primepi
def A078840_T(n,k):
    if n == 1: return prime(k)
    def g(x,a,b,c,m): yield from (((d,) for d in enumerate(primerange(b,isqrt(x//c)+1),a)) if m==2 else (((a2,b2),)+d for a2,b2 in enumerate(primerange(b,integer_nthroot(x//c,m)[0]+1),a) for d in g(x,a2,b2,c*b2,m-1)))
    def f(x): return int(k-1+x-sum(primepi(x//prod(c[1] for c in a))-a[-1][0] for a in g(x,0,1,1,n)))
    kmin, kmax = 1,2
    while f(kmax) >= kmax:
        kmax <<= 1
    while True:
        kmid = kmax+kmin>>1
        if f(kmid) < kmid:
            kmax = kmid
        else:
            kmin = kmid
        if kmax-kmin <= 1:
            break
    return kmax # _Chai Wah Wu_, Aug 23 2024
```
