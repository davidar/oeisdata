# a\(1\)\=1, a\(2\)\=3, a\(3\)\=2; thereafter a\(n\) is the smallest number not occurring earlier having at least one common factor with a\(n\-2\), but none with a\(n\-1\)\.
https://oeis.org/A251555
## JSON
```JSON
[1, 3, 2, 9, 4, 15, 8, 5, 6, 25, 12, 35, 16, 7, 10, 21, 20, 27, 14, 33, 26, 11, 13, 22, 39, 28, 45, 32, 51, 38, 17, 18, 85, 24, 55, 34, 65, 36, 91, 30, 49, 40, 63, 44, 57, 46, 19, 23, 76, 69, 50, 81, 52, 75, 56, 87, 62, 29, 31, 58, 93, 64, 99, 68, 77, 48, 119, 54, 133, 60, 161, 66, 115, 42, 95, 72, 125]
```
## Mathematica
```Mathematica
a[1]=1; a[2]=3; a[3]=2;
```
```Mathematica
A251555 = Array[a, 3];
```
```Mathematica
a[n_] := a[n] = For[k=2, True, k++, If[FreeQ[A251555, k], If[!CoprimeQ[k, a[n-2]] && CoprimeQ[k, a[n-1]], AppendTo[A251555, k]; Return[k]]]];
```
```Mathematica
A251555 = Array[a, 100] (* _Jean-FranÃ§ois Alcover_, Aug 02 2018 *)
```
## Python
```Python
from fractions import gcd
A251555_list, l1, l2, s, b = [1,3,2], 2, 3, 4, set()
for _ in range(10**4):
....i = s
....while True:
........if not i in b and gcd(i,l1) == 1 and gcd(i,l2) > 1:
............A251555_list.append(i)
............l2, l1 = l1, i
............b.add(i)
............while s in b:
................b.remove(s)
................s += 1
............break
........i += 1 # _Chai Wah Wu_, Dec 21 2014
```
## Haskell
```Haskell
import Data.List (delete)
a251555 n = a251555_list !! (n-1)
a251555_list = 1 : 3 : 2 : f 3 2 [4..] where
   f u v ws = g ws where
     g (x:xs) = if gcd x u > 1 && gcd x v == 1
                   then x : f v x (delete x ws) else g xs
-- _Reinhard Zumkeller_, Dec 24 2014
```
