# a\(n\) \= 2n\-1 if n <\= 3, otherwise the smallest odd number not occurring earlier having at least one common factor with a\(n\-2\), but none with a\(n\-1\)\.
https://oeis.org/A251413
## JSON
```JSON
[1, 3, 5, 9, 25, 21, 55, 7, 11, 35, 33, 49, 15, 77, 27, 91, 45, 13, 51, 65, 17, 39, 85, 57, 115, 19, 23, 95, 69, 125, 63, 145, 81, 29, 75, 203, 93, 119, 31, 105, 341, 87, 121, 111, 143, 37, 99, 185, 117, 155, 123, 175, 41, 133]
```
## Maple
```Maple
N:= 10^3: # to get a(1) to a(n) where a(n+1) is the first term > N
B:= Vector(N, datatype=integer[4]):
for n from 1 to 3 do A[n]:= 2*n-1: od:
for n from 4 do
  for k from 4 to N do
    if B[k] = 0 and igcd(2*k-1, A[n-1]) = 1 and igcd(2*k-1, A[n-2]) > 1 then
       A[n]:= 2*k-1;
       B[k]:= 1;
       break
    fi
  od:
  if 2*k-1 > N then break fi
od:
seq(A[i], i=1..n-1); # Based on _Robert Israel_'s program for A098550
```
## Mathematica
```Mathematica
max = 54; f = True; a = {1, 3, 5}; NN = Range[4, 1000]; s = 2*NN - 1; While[TrueQ[f], For[k = 1, k <= Length[s], k++, If[Length[a] < max, If[GCD[a[[-1]], s[[k]]] == 1 && GCD[a[[-2]], s[[k]]] > 1, a = Append[a, s[[k]]]; s = Delete[s, k]; k = 0; Break], f = False]]]; a (* _L. Edson Jeffery_, Dec 02 2014 *)
```
## Python
```Python
from fractions import gcd
A251413_list, l1, l2, s, b = [1,3,5], 5, 3, 7, {}
for _ in range(1,10**4):
....i = s
....while True:
........if not i in b and gcd(i,l1) == 1 and gcd(i,l2) > 1:
............A251413_list.append(i)
............l2, l1, b[i] = l1, i, True
............while s in b:
................b.pop(s)
................s += 2
............break
........i += 2 # _Chai Wah Wu_, Dec 07 2014
```
## Haskell
```Haskell
import Data.List (delete)
a251413 n = a251413_list !! (n-1)
a251413_list = 1 : 3 : 5 : f 3 5 [7, 9 ..] where
   f u v ws = g ws where
     g (x:xs) = if gcd x u > 1 && gcd x v == 1
                   then x : f v x (delete x ws) else g xs
-- _Reinhard Zumkeller_, Dec 25 2014
```
