# The Doudna sequence: write n\-1 in binary; power of prime\(k\) in a\(n\) is \# of 1's that are followed by k\-1 0's\.
https://oeis.org/A005940
## JSON
```JSON
[1, 2, 3, 4, 5, 6, 9, 8, 7, 10, 15, 12, 25, 18, 27, 16, 11, 14, 21, 20, 35, 30, 45, 24, 49, 50, 75, 36, 125, 54, 81, 32, 13, 22, 33, 28, 55, 42, 63, 40, 77, 70, 105, 60, 175, 90, 135, 48, 121, 98, 147, 100, 245, 150, 225, 72, 343, 250, 375, 108, 625, 162, 243, 64, 17, 26, 39]
```
## Maple
```Maple
f := proc(n,i,x) option remember ; if n = 0 then x; elif type(n,'even') then procname(n/2,i+1,x) ; else procname((n-1)/2,i,x*ithprime(i)) ; end if; end proc:
A005940 := proc(n) f(n-1,1,1) ; end proc: # _R. J. Mathar_, Mar 06 2010
```
## Mathematica
```Mathematica
f[n_] := Block[{p = Partition[ Split[ Join[ IntegerDigits[n - 1, 2], {2}]], 2]}, Times @@ Flatten[ Table[q = Take[p, -i]; Prime[ Count[ Flatten[q], 0] + 1]^q[[1, 1]], {i, Length[p]}] ]]; Table[ f[n], {n, 67}] (* _Robert G. Wilson v_, Feb 22 2005 *)
```
```Mathematica
Table[Times@@Prime/@(Join@@Position[Reverse[IntegerDigits[n,2]],1]-Range[DigitCount[n,2,1]]+1),{n,0,100}] (* _Gus Wiseman_, Dec 28 2022 *)
```
## PARI
```PARI
A005940(n) = { my(p=2, t=1); n--; until(!n\=2, n%2 && (t*=p) || p=nextprime(p+1)); t } \\ _M. F. Hasler_, Mar 07 2010; update Aug 29 2014
```
```PARI
a(n)=my(p=2, t=1); for(i=0,exponent(n), if(bittest(n,i), t*=p, p=nextprime(p+1))); t \\ _Charles R Greathouse IV_, Nov 11 2021
```
## Haskell
```Haskell
a005940 n = f (n - 1) 1 1 where
   f 0 y _          = y
   f x y i | m == 0 = f x' y (i + 1)
           | m == 1 = f x' (y * a000040 i) i
           where (x',m) = divMod x 2
-- _Reinhard Zumkeller_, Oct 03 2012
```
## Scheme
```Scheme
(define (A005940 n) (A005940off0 (- n 1))) ;; The off=1 version, utilizing any one of three different offset-0 implementations:
(definec (A005940off0 n) (cond ((< n 2) (+ 1 n)) (else (* (A000040 (- (A070939 n) (- (A000120 n) 1))) (A005940off0 (A053645 n))))))
(definec (A005940off0 n) (cond ((<= n 2) (+ 1 n)) ((even? n) (A003961 (A005940off0 (/ n 2)))) (else (* 2 (A005940off0 (/ (- n 1) 2))))))
(define (A005940off0 n) (let loop ((n n) (i 1) (x 1)) (cond ((zero? n) x) ((even? n) (loop (/ n 2) (+ i 1) x)) (else (loop (/ (- n 1) 2) i (* x (A000040 i)))))))
;; _Antti Karttunen_, Jun 26 2014
```
## Python
```Python
from sympy import prime
import math
def A(n): return n - 2**int(math.floor(math.log(n, 2)))
def b(n): return n + 1 if n<2 else prime(1 + (len(bin(n)[2:]) - bin(n)[2:].count("1"))) * b(A(n))
print([b(n - 1) for n in range(1, 101)]) # _Indranil Ghosh_, Apr 10 2017
```
```Python
from math import prod
from itertools import accumulate
from collections import Counter
from sympy import prime
def A005940(n): return prod(prime(len(a)+1)**b for a, b in Counter(accumulate(bin(n-1)[2:].split('1')[:0:-1])).items()) # _Chai Wah Wu_, Mar 10 2023
```
