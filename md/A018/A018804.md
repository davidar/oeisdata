# Pillai's arithmetical function: Sum\_\{k\=1\.\.n\} gcd\(k, n\)\.
https://oeis.org/A018804
## JSON
```JSON
[1, 3, 5, 8, 9, 15, 13, 20, 21, 27, 21, 40, 25, 39, 45, 48, 33, 63, 37, 72, 65, 63, 45, 100, 65, 75, 81, 104, 57, 135, 61, 112, 105, 99, 117, 168, 73, 111, 125, 180, 81, 195, 85, 168, 189, 135, 93, 240, 133, 195, 165, 200, 105, 243, 189, 260, 185, 171, 117, 360]
```
## Maple
```Maple
a:=n->sum(igcd(n,j),j=1..n): seq(a(n), n=1..60); # _Zerinvary Lajos_, Nov 05 2006
```
## Mathematica
```Mathematica
f[n_] := Block[{d = Divisors[n]}, Sum[ d*EulerPhi[n/d], {d, d}]]; Table[f[n], {n, 60}] (* _Robert G. Wilson v_, Mar 20 2012 *)
```
```Mathematica
a[ n_] := If[ n < 1, 0, n Sum[ EulerPhi[d] / d, {d, Divisors@n}]]; (* _Michael Somos_, Jan 07 2017 *)
```
```Mathematica
f[p_, e_] := (e*(p - 1)/p + 1)*p^e; a[n_] := Times @@ (f @@@ FactorInteger[n]); Array[a, 100] (* _Amiram Eldar_, Jul 19 2019 *)
```
## PARI
```PARI
{a(n) = direuler(p=2, n, (1 - X) / (1 - p*X)^2)[n]}; /* _Michael Somos_, May 31 2000 */
```
```PARI
a(n)={ my(ct=0); for(i=0,n-1,for(j=0,n-1, ct+=(Mod(i*j,n)==0) ) ); ct; } \\ _Joerg Arndt_, Aug 03 2013
```
```PARI
a(n)=my(f=factor(n)); prod(i=1,#f~,(f[i,2]*(f[i,1]-1)/f[i,1] + 1)*f[i,1]^f[i,2]) \\ _Charles R Greathouse IV_, Oct 28 2014
```
```PARI
a(n) = sumdiv(n, d, n*eulerphi(d)/d); \\ _Michel Marcus_, Jan 07 2017
```
## Haskell
```Haskell
a018804 n = sum $ map (gcd n) [1..n]  -- _Reinhard Zumkeller_, Jul 16 2012
```
## Python
```Python
from sympy.ntheory import totient, divisors
print([sum(n*totient(d)//d for d in divisors(n)) for n in range(1, 101)]) # _Indranil Ghosh_, Apr 04 2017
```
```Python
from sympy import factorint
from math import prod
def A018804(n): return prod(p**(e-1)*((p-1)*e+p) for p, e in factorint(n).items()) # _Chai Wah Wu_, Nov 29 2021
```
## Magma
```Magma
[&+[Gcd(n,k):k in [1..n]]:n in [1..60]]; // _Marius A. Burtea_, Nov 14 2019
```
