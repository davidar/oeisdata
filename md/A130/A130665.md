# a\(n\) \= Sum\_\{k\=0\.\.n\} 3^wt\(k\), where wt\(\) \= A000120\(\)\.
https://oeis.org/A130665
## JSON
```JSON
[1, 4, 7, 16, 19, 28, 37, 64, 67, 76, 85, 112, 121, 148, 175, 256, 259, 268, 277, 304, 313, 340, 367, 448, 457, 484, 511, 592, 619, 700, 781, 1024, 1027, 1036, 1045, 1072, 1081, 1108, 1135, 1216, 1225, 1252, 1279, 1360, 1387, 1468, 1549, 1792, 1801, 1828, 1855]
```
## Maple
```Maple
u:=3; a[1]:=1; M:=30; for n from 1 to M do a[2*n] := (u+1)*a[n]; a[2*n+1] := u*a[n] + a[n+1]; od; t1:=[seq( a[n], n=1..2*M )]; # Gives sequence with a different offset
```
## Mathematica
```Mathematica
f[n_] := Sum[3^Count[ IntegerDigits[k, 2], 1], {k, 0, n}]; Array[f, 51, 0] (* _Robert G. Wilson v_, Jun 28 2010 *)
```
## Haskell
```Haskell
a130665 = sum . map (3 ^) . (`take` a000120_list) . (+ 1)
-- _Reinhard Zumkeller_, Apr 18 2012
```
## Python
```Python
def a(n):  # formula version, n=10^10000 takes ~1 second
    if n == 0:
        return 1
    msb = 1 << (n.bit_length() - 1)
    return msb**2 + 3 * a(n-msb) # _Stefan Pochmann_, Mar 15 2023
```
```Python
def a(n):  # optimized, n=10^50000 takes ~1 second
    n += 1
    total = 0
    power3 = 1
    while n:
        log = n.bit_length() - 1
        total += power3 << (2*log)
        n -= 1 << log
        power3 *= 3
    return total # _Stefan Pochmann_, Mar 15 2023
```
