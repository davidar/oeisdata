# a\(n\) is the largest j such that A278115\(n,k\) strictly decreases for k\=1\.\.j\.
https://oeis.org/A278116
## JSON
```JSON
[1, 2, 3, 3, 4, 3, 2, 2, 5, 4, 4, 2, 2, 3, 3, 5, 3, 2, 2, 4, 3, 3, 2, 2, 3, 4, 6, 6, 2, 3, 4, 3, 3, 2, 2, 3, 5, 4, 4, 2, 4, 3, 4, 3, 2, 2, 3, 4, 3, 2, 2, 4, 3, 4, 3, 2, 2, 3, 4, 3, 2, 2, 3, 3, 5, 3, 2, 2, 4, 5, 4, 2, 2, 3, 3, 4, 3, 2, 3, 4, 7, 5, 2, 2, 3, 4, 2, 2, 2, 3, 5, 5, 5, 2, 2, 3, 4, 3, 2, 2, 4, 5, 3, 3, 2]
```
## Mathematica
```Mathematica
Map[1 + Length@ TakeWhile[Differences@ #, # < 0 &] &, #] &@ Table[# Floor[n Sqrt[2/#]]^2 &@ Prime@ k, {n, 105}, {k, PrimePi[2 n^2]}] (* _Michael De Vlieger_, Feb 17 2017 *)
```
## Magma
```Magma
A:=func<n,k|Isqrt(2*n^2 div k)^2*k>;
A278116:=func<n|(exists(j){j:j in[1..#P-1]|A(n,P[j])le A278115(n,P[j+1])}
  select j else #P) where P is PrimesUpTo(2*n^2)>;
[A278116(n):n in[1..103]];
```
## Python
```Python
def isqrt(n):
    if n < 0:
        raise ValueError('imaginary')
    if n == 0:
        return 0
    a, b = divmod(n.bit_length(),2)
    x = 2**(a+b)
    while True:
        y = (x + n//x)//2
        if y >= x:
            return x
        x = y;
def next_prime(n):
    for p in range(n+1,2*n+1):
        for i in range(2,isqrt(n)+1):
            if p % i == 0:
                break
        else:
            return p
    return None
def A278116(n):
    k = 0
    p = 2
    s2= (n**2)*p
    s = s2
    while True:
        s_= s
        k+= 1
        p = next_prime(p)
        s = (isqrt(s2//p)**2)*p
        if s > s_:
            break
    return k
```
