# Number of Dean words of length n, i\.e\., squarefree reduced words over \{0,1,2,3\}\.
https://oeis.org/A343421
## JSON
```JSON
[4, 8, 16, 24, 40, 64, 104, 144, 216, 328, 496, 720, 1072, 1584, 2344, 3384, 4952, 7264, 10632, 15504, 22656, 33136, 48488, 70592, 103032, 150352, 219400, 319816, 466664, 680872, 993440, 1447952, 2111448, 3079464, 4491216, 6548936, 9550728, 13927840, 20311168]
```
## C++
```C++
#include <iostream>
#include <vector>
bool good (const std::string& s) {
    long n = s.size();
    for (long i = 1; i <= n/2; i++) {
        bool match = true;
        for (long j = 0; j < i; j++) {
            if (s[n-i+j] != s[n-2*i+j]) {
                match = false; break; } }
        if (match) return false; }
    return true; }
std::vector<std::string> s = {"01"}, t, d = {"02", "13"};
int main () {
    std::cout << "1 4\n";
    for (long i = 2; i < 40; i++) {
        std::cout << i << " " << 8*s.size() << "\n";
        for (char c : d[i%2]) {
            for (const std::string& x : s) {
                if (good(x+c)) t.push_back(x+c); } }
        s.swap(t); t = std::vector<std::string>(); } } // _James Rayman_, Apr 15 2021
```
## Python
```Python
def isf(s): # incrementally squarefree (check factors ending in last letter)
    for l in range(1, len(s)//2 + 1):
        if s[-2*l:-l] == s[-l:]: return False
    return True
def aupton(nn, verbose=False):
    alst, sfs = [], set("0")
    for n in range(1, nn+1):
        an, eo = 4*len(sfs), ["02", "13"]
        sfsnew = set(s+i for s in sfs for i in eo[n%2] if isf(s+i))
        alst, sfs = alst+[an], sfsnew
        if verbose: print(n, an)
    return alst
print(aupton(30)) # _Michael S. Branicky_, Jun 20 2022
```
