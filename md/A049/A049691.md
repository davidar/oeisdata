# a\(n\)\=T\(n,n\), array T as in A049687\. Also a\(n\)\=T\(2n,2n\), array T given by A049639\.
https://oeis.org/A049691
## JSON
```JSON
[0, 3, 5, 9, 13, 21, 25, 37, 45, 57, 65, 85, 93, 117, 129, 145, 161, 193, 205, 241, 257, 281, 301, 345, 361, 401, 425, 461, 485, 541, 557, 617, 649, 689, 721, 769, 793, 865, 901, 949, 981, 1061, 1085, 1169, 1209, 1257, 1301, 1393, 1425, 1509, 1549]
```
## Maple
```Maple
Farey := proc(n) sort(convert(`union`({0}, {seq(seq(m/k, m=1..k), k=1..n)}), list)) end: # A006842/A006843
BF := proc(m) local a,i,h,k; global Farey; a:=[];
for i in Farey(2*m) do h:=numer(i); k:=denom(i);
if (h <= m) and (k-m <= h) then a:=[op(a),i]; fi; od: a; end;
[seq(nops(BF(m),m=1..20)]; # this sequence - _N. J. A. Sloane_, Sep 08 2019
```
## Mathematica
```Mathematica
a[0] = 0; a[n_] := 2 + Sum[Quotient[n, g]^2*MoebiusMu[g], {g, 1, n}]; Table[a[n], {n, 0, 50}] (* _Jean-FranÃ§ois Alcover_, Oct 07 2017, translated from PARI *)
```
## PARI
```PARI
a(n) = if(n>0, 2, 0) + sum(g=1, n, (n\g)^2 * moebius(g)); \\ _Andrew Howroyd_, Sep 17 2017
```
```PARI
a(n) = if(n>0, 1, 0) + 2 * sum(k=1, n, eulerphi(k)); \\ _Torlach Rush_, Nov 24 2020
```
```PARI
a(n)=#Set(concat([[c/d|c<-[-d..d],d]|d<-[0..n]])) \\ For illustrative purpose only! - _M. F. Hasler_, Mar 26 2023
```
## Python
```Python
from functools import lru_cache
@lru_cache(maxsize=None)
def A049691(n):
    if n == 0:
        return 0
    c, j = 1, 2
    k1 = n//j
    while k1 > 1:
        j2 = n//k1 + 1
        c += (j2-j)*(A049691(k1)-2)
        j, k1 = j2, n//j2
    return n*(n-1)-c+j+2 # _Chai Wah Wu_, Aug 04 2024
```
