# The Enots Wolley sequence: the lexicographically earliest infinite sequence \{a\(n\)\} of distinct positive numbers such that, for n\>2, a\(n\) has a common factor with a\(n\-1\) but not with a\(n\-2\)\.
https://oeis.org/A336957
## JSON
```JSON
[1, 2, 6, 15, 35, 14, 12, 33, 55, 10, 18, 21, 77, 22, 20, 45, 39, 26, 28, 63, 51, 34, 38, 57, 69, 46, 40, 65, 91, 42, 30, 85, 119, 56, 24, 75, 95, 76, 36, 87, 145, 50, 44, 99, 93, 62, 52, 117, 105, 70, 58, 261, 111, 74, 68, 153, 123, 82, 80, 115, 161, 84, 60, 155, 217, 98, 48, 129, 215, 100]
```
## Maple
```Maple
with(numtheory);
N:= 10^4: # to get a(1) to a(n) where a(n+1) is the first term > N
B:= Vector(N, datatype=integer[4]):
for n from 1 to 2 do A[n]:= n: od:
for n from 3 do
  for k from 3 to N do
    if B[k] = 0 and igcd(k, A[n-1]) > 1 and igcd(k, A[n-2]) = 1 then
          if nops(factorset(k) minus factorset(A[n-1])) > 0 then
       A[n]:= k;
       B[k]:= 1;
       break;
          fi;
    fi
  od:
  if k > N then break; fi;
od:
s1:=[seq(A[i], i=1..n-1)]; # _N. J. A. Sloane_, Sep 24 2020, based on Theorem 1 and _Robert Israel_'s program for sequence A098550
```
## Mathematica
```Mathematica
M = 1000;
```
```Mathematica
A[1] = 1; A[2] = 2;
```
```Mathematica
Clear[B]; B[_] = 0;
```
```Mathematica
For[n = 3, True, n++,
```
```Mathematica
For[k = 3, k <= M, k++,
```
```Mathematica
If[B[k] == 0 && GCD[k, A[n-1]] > 1 && GCD[k, A[n-2]] == 1, If[Length[ FactorInteger[k][[All, 1]] ~Complement~ FactorInteger[A[n-1]][[All, 1]]] > 0, A[n] = k; B[k] = 1; Break[]]]]; If[k > M, Break[]]];
```
```Mathematica
Array[A, n-1] (* _Jean-FranÃ§ois Alcover_, Oct 20 2020, after Maple *)
```
## Python
```Python
from math import gcd
from sympy import factorint
from itertools import count, islice
def agen(): # generator of terms
    a, seen, minan = [1, 2], {1, 2}, 3
    yield from a
    for n in count(3):
        an, fset = minan, set(factorint(a[-1]))
        while True:
            if an not in seen and gcd(an, a[-1])>1 and gcd(an, a[-2])==1:
                if set(factorint(an)) - fset > set():
                    break
            an += 1
        a.append(an); seen.add(an); yield an
        while minan in seen: minan += 1
print(list(islice(agen(), 70))) # _Michael S. Branicky_, Jan 22 2022
```
