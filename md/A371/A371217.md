# The maximum deck size to perform Colm Mulcahy's n\-card trick\.
https://oeis.org/A371217
## JSON
```JSON
[1, 4, 15, 52, 197, 896, 4987, 33216, 257161, 2262124, 22241671, 241476060, 2867551117, 36960108680, 513753523571, 7659705147976, 121918431264273, 2063255678027668, 36991535865656959, 700377953116334788, 13963866589144933461, 292421219327021540176, 6417047546280200867819]
```
## Maple
```Maple
a:= proc(n) option remember; `if`(n<4, n*(n^2-2*n+2),
      ((11*n^2-66*n-61)*a(n-1) -(17*n^2-155*n+134)*a(n-2)
       +(n-3)*(n-81)*a(n-3) +(n-4)*(5*n+26)*a(n-4))/(11*n-72))
    end:
seq(a(n), n=1..23);  # _Alois P. Heinz_, Mar 18 2024
```
## Mathematica
```Mathematica
Table[1 + (k - 1)(2 Sum[Binomial[k - 1, i] (i - 1)!, {i, 1, k - 1}] + 1), {k, 20}]
```
## Python
```Python
from math import factorial
def A371217(n): return n+((n-1)*sum(factorial(n-1)//((i+1)*factorial(n-i-2)) for i in range(n-1))<<1) # _Chai Wah Wu_, May 02 2024
```
