# Array read by antidiagonals: The number of parades with n girls and k boys that begin with a girl and end with a boy\.
https://oeis.org/A371761
## JSON
```JSON
[1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 5, 1, 0, 0, 1, 13, 13, 1, 0, 0, 1, 29, 73, 29, 1, 0, 0, 1, 61, 301, 301, 61, 1, 0, 0, 1, 125, 1081, 2069, 1081, 125, 1, 0, 0, 1, 253, 3613, 11581, 11581, 3613, 253, 1, 0, 0, 1, 509, 11593, 57749, 95401, 57749, 11593, 509, 1, 0]
```
## Maple
```Maple
egf := 1/(exp(w) + exp(z) - exp(w + z)): serw := n -> series(egf, w, n + 1):
# Returns row n (>= 0) with length len (> 0):
R := n -> len -> local k;
seq(k!*coeff(series(n!*coeff(serw(n), w, n), z, len), z, k), k = 0..len - 1):
seq(lprint(R(n)(9)), n = 0..7);
# Explicit with Stirling2 :
A := (n, k) -> local j; add(j!^2*Stirling2(n, j)*Stirling2(k, j), j = 0..min(n, k)): seq(lprint(seq(A(n, k), k = 0..8)), n = 0..7);
# Using the unsigned Worpitzky transform.
WT := (a, len) -> local n, k;
seq(add((-1)^(n - k)*k!*Stirling2(n + 1, k + 1)*a(k), k=0..n), n = 0..len-1):
Arow := n -> WT(x -> x^n, 8): seq(lprint(Arow(n)), n = 0..8);
# Two recurrences:
A := proc(n, k) option remember; local j; if k = 0 then return k^n fi;
add(binomial(n, j)*(A(n-j, k-1) + A(n-j+1, k-1)), j = 1..n) end:
A := proc(n, k) option remember; local j; if n = 0 then 0^k else
add(binomial(k + `if`(j=0,0,1), j+1)*A(n-1, k-j), j = 0..k) fi end:
```
## Mathematica
```Mathematica
(* Using the unsigned Worpitzky transform. *)
```
```Mathematica
Unprotect[Power]; Power[0, 0] = 1;
```
```Mathematica
W[n_, k_] := (-1)^(n - k) k! StirlingS2[n + 1, k + 1];
```
```Mathematica
WT[a_, len_] := Table[Sum[W[n, k] a[k], {k, 0, n}], {n, 0, len-1}];
```
```Mathematica
A371761row[n_, len_] := WT[#^n &, len];
```
```Mathematica
Table[A371761row[n, 9], {n, 0, 8}] // MatrixForm
```
```Mathematica
(* Row n >= 1 by linear recurrence: *)
```
```Mathematica
RowByLRec[n_, len_] := LinearRecurrence[Table[-StirlingS1[n+1, n+1-k], {k, 1, n}],
```
```Mathematica
A371761row[n, n+1], len]; Table[RowByLRec[n, 9], {n, 1, 8}] // MatrixForm
```
## Sage
```Sage
def A371761(n, k): return sum((-1)^(j - k) * factorial(j) * stirling_number2(k + 1, j + 1) * j^n for j in range(k + 1))
for n in range(9): print([A371761(n, k) for k in range(8)])
```
## Python
```Python
from functools import cache
from math import comb as binomial
@cache
def A(n, k):
    if n == 0: return int(k == 0)
    return sum(binomial(k + int(j > 0), j + 1) * A(n - 1, k - j)
           for j in range(k + 1))
for n in range(8): print([A(n, k) for k in range(8)])
```
```Python
# The Akiyama-Tanigawa algorithm for powers generates the rows.
def ATPowList(n, len):
    A = [0] * len
    R = [0] * len
    for k in range(len):
        R[k] = k**n   # Changing this to R[k] = (n + 1)**k generates A344499.
        for j in range(k, 0, -1):
            R[j - 1] = j * (R[j] - R[j - 1])
        A[k] = R[0]
    return A
for n in range(8): print([n], ATPowList(n, 9))
```
