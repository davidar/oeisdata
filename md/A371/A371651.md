# a\(n\) is the first prime p such that p \- 2 and p \+ 2 both have exactly n prime factors, counted with multiplicity\.
https://oeis.org/A371651
## JSON
```JSON
[5, 23, 173, 2693, 32587, 495637, 4447627, 35303123, 717591877, 928090627, 69692326373, 745041171877, 5012236328123, 64215009765623, 945336806640623, 8885812685546873]
```
## Maple
```Maple
V:= Vector(8):
p:= 3: count:= 0:
while count < 8 do
p:= nextprime(p);
i:= numtheory:-bigomega(p-2);
if i <= 8 and V[i] = 0 and numtheory:-bigomega(p+2) = i
     then V[i]:= p; count:= count+1
  fi
od:
convert(V,list);
```
## Python
```Python
from sympy import primeomega, nextprime
def A371651(n):
    p = 3
    while True:
        if n == primeomega(p-2) == primeomega(p+2):
            return p
        p = nextprime(p) # _Chai Wah Wu_, Apr 02 2024
```
## PARI
```PARI
generate(A, B, n) = A=max(A, 2^n); (f(m, p, j) = my(list=List()); if(j==1, forprime(q=max(p,ceil(A/m)), B\m, my(t=m*q); if(isprime(t-2) && bigomega(t-4) == n, listput(list, t-2))), forprime(q = p, sqrtnint(B\m, j), list=concat(list, f(m*q, q, j-1)))); list); vecsort(Vec(f(1, 3, n)));
a(n) = my(x=2^n, y=2*x); while(1, my(v=generate(x, y, n)); if(#v >= 1, return(v[1])); x=y+1; y=2*x); \\ _Daniel Suteu_, Apr 13 2024
```
