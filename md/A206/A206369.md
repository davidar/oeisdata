# a\(p^k\) \= p^k \- p^\(k\-1\) \+ p^\(k\-2\) \- \.\.\. \+\- 1, and then extend by multiplicativity\.
https://oeis.org/A206369
## JSON
```JSON
[1, 1, 2, 3, 4, 2, 6, 5, 7, 4, 10, 6, 12, 6, 8, 11, 16, 7, 18, 12, 12, 10, 22, 10, 21, 12, 20, 18, 28, 8, 30, 21, 20, 16, 24, 21, 36, 18, 24, 20, 40, 12, 42, 30, 28, 22, 46, 22, 43, 21, 32, 36, 52, 20, 40, 30, 36, 28, 58, 24, 60, 30, 42, 43, 48, 20, 66, 48, 44, 24, 70, 35]
```
## Maple
```Maple
a:= n-> mul(add(i[1]^(i[2]-j)*(-1)^j, j=0..i[2]), i=ifactors(n)[2]):
seq(a(n), n=1..100);  # _Alois P. Heinz_, Nov 03 2017
```
## Mathematica
```Mathematica
Table[Length[Select[Range[n], IntegerQ[GCD[n, #]^(1/2)] &]], {n, 72}] (* _Geoffrey Critzer_, Feb 16 2015 *)
```
```Mathematica
a[n_] := n*DivisorSum[n, LiouvilleLambda[#]/#&]; Array[a, 72] (* _Jean-François Alcover_, Dec 04 2017, after _Enrique Pérez Herrero_ *)
```
```Mathematica
f[p_,e_] := Sum[(-1)^(e-k)*p^k, {k,0,e}]; a[1] = 1; a[n_] := Times @@ (f @@@ FactorInteger[n]); Array[a, 100] (* _Amiram Eldar_, Jan 01 2020 *)
```
## Haskell
```Haskell
a206369 n = product $
   zipWith h (a027748_row n) (map toInteger $ a124010_row n) where
           h p e = sum $ take (fromInteger e + 1) $
                         iterate ((* p) . negate) (1 - 2 * (e `mod` 2))
-- _Reinhard Zumkeller_, Feb 08 2012
```
## PARI
```PARI
a(n) = sum(k=1, n, issquare(gcd(n, k)));
```
```PARI
ak(p,e)=my(s=1); for(i=1,e, s=s*p + (-1)^i); s
a(n)=my(f=factor(n)); prod(i=1,#f~, ak(f[i,1],f[i,2])) \\ _Charles R Greathouse IV_, Dec 27 2016
```
```PARI
a(n) = sumdiv(n, d, eulerphi(n/d) * issquare(d)); \\ _Daniel Suteu_, Jun 27 2018
```
```PARI
apply( {A206369(n)=vecprod([f[1]^(f[2]+1)\/(f[1]+1)|f<-factor(n)~])}, [1..99]) \\ _M. F. Hasler_, Feb 13 2020
```
## Python
```Python
from math import prod
from sympy import factorint
def A206369(n): return prod((lambda x:x[0]+int((x[1]<<1)>=p+1))(divmod(p**(e+1),p+1)) for p, e in factorint(n).items()) # _Chai Wah Wu_, Mar 05 2024
```
