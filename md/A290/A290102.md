# Start from the singleton set S \= \{n\}, and generate on each iteration a new set where each odd number k is replaced by 3k\+1, and each even number k is replaced by 3k\+1 and k/2\. a\(n\) is the size of the set after the first iteration which has produced a number smaller than n\. a\(1\) \= 1 by convention\.
https://oeis.org/A290102
## JSON
```JSON
[1, 2, 9, 2, 3, 2, 52, 2, 3, 2, 18, 2, 3, 2, 49, 2, 3, 2, 9, 2, 3, 2, 18, 2, 3, 2, 395, 2, 3, 2, 1108, 2, 3, 2, 9, 2, 3, 2, 52, 2, 3, 2, 18, 2, 3, 2, 360, 2, 3, 2, 9, 2, 3, 2, 18, 2, 3, 2, 57, 2, 3, 2, 1116, 2, 3, 2, 9, 2, 3, 2, 115, 2, 3, 2, 18, 2, 3, 2, 109, 2, 3, 2, 9, 2, 3, 2, 18, 2, 3, 2, 56, 2, 3, 2, 105, 2, 3, 2, 9, 2, 3, 2, 368, 2, 3, 2, 18]
```
## Mathematica
```Mathematica
Table[-2 Boole[n == 1] + Length@ Last@ NestWhileList[Union@ Flatten[# /. {k_ /; OddQ@ k :> 3 k + 1, k_ /; EvenQ@ k :> {k/2, 3 k + 1}}] &, {n}, AllTrue[#, # > n &] &, {2, 1}], {n, 107}] (* _Michael De Vlieger_, Aug 20 2017 *)
```
## PARI
```PARI
A290102(n) = { if(1==n,return(1)); my(S, k); S=[n]; k=0; while( S[1]>=n, k++; S=vecsort( concat(apply(x->3*x+1, S), apply(x->x\2, select(x->x%2==0, S) )), , 8);  ); length(S); } \\ After _Max Alekseyev_'s code for A127885, see also A290101.
```
## Python
```Python
from sympy import flatten
def ok(n, L):
    return any(i < n for i in L)
def a(n):
    if n==1: return 1
    L=[n]
    while not ok(n, L):
        L=set(flatten([[3*k + 1, k//2] if k%2==0 else 3*k + 1 for k in L]))
    return len(L)
print([a(n) for n in range(1, 121)]) # _Indranil Ghosh_, Aug 22 2017
```
