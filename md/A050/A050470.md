# a\(n\) \= Sum\_\{d\|n, n/d \=\= 1 \(mod 4\)\} d^2 \- Sum\_\{d\|n, n/d \=\= 3 \(mod 4\)\} d^2\.
https://oeis.org/A050470
## JSON
```JSON
[1, 4, 8, 16, 26, 32, 48, 64, 73, 104, 120, 128, 170, 192, 208, 256, 290, 292, 360, 416, 384, 480, 528, 512, 651, 680, 656, 768, 842, 832, 960, 1024, 960, 1160, 1248, 1168, 1370, 1440, 1360, 1664, 1682, 1536, 1848, 1920, 1898, 2112, 2208, 2048, 2353, 2604]
```
## Mathematica
```Mathematica
a[ n_] := SeriesCoefficient[ q (QPochhammer[ q^2]^3 (QPochhammer[ q^4] / QPochhammer[ q])^2)^2, {q, 0, n}]; (* _Michael Somos_, May 17 2015 *)
```
```Mathematica
a[ n_] := SeriesCoefficient[ (EllipticTheta[ 3, 0, q] EllipticTheta[ 2, 0, q]^2 / 4)^2, {q, 0, n}]; (* _Michael Somos_, May 17 2015 *)
```
```Mathematica
a[ n_] := If[ n < 1, 0, Sum[ d^2 Mod[n/d, 2] (-1)^Quotient[n/d, 2], {d, Divisors@n}]]; (* _Michael Somos_, May 17 2015 *)
```
```Mathematica
s[n_] := If[OddQ[n], (-1)^((n-1)/2), 0]; (* A101455 *)
```
```Mathematica
f[p_, e_] := (p^(2*e+2) - s[p]^(e+1))/(p^2 - s[p]); a[1] = 1; a[n_] := Times @@ f @@@ FactorInteger[n]; Array[a, 100] (* _Amiram Eldar_, Nov 04 2023 *)
```
## PARI
```PARI
{a(n) = if( n<1, 0, sumdiv( n, d, d^2 * (n/d%2) * (-1)^(n/d\2)))};
```
```PARI
{a(n) = my(A); if( n<1, 0, n--; A = x * O(x^n); polcoeff( eta(x^2 + A)^6 * (eta(x^4 + A) / eta(x + A))^4, n))}; /* _Michael Somos_, May 17 2015 */
```
## Haskell
```Haskell
a050470 n = a050461 n - a050465 n  -- _Reinhard Zumkeller_, Mar 06 2012
```
## Magma
```Magma
Basis( ModularForms( Gamma1(4), 3), 51) [2]; /* _Michael Somos_, May 17 2015 */
```
## Python
```Python
from math import prod
from sympy import factorint
def A050470(n): return prod((p**(e+1<<1)-(m:=(0,1,0,-1)[p&3]))//(p**2-m) for p, e in factorint(n).items()) # _Chai Wah Wu_, Jun 21 2024
```
