# Write n as 2^m \- k, where 2^m is the least power of 2 such that 2^m \>\= n, and k is a number in the range 0 <\= k < 2^\(m\-1\) \- 1\. Then for n such that k\=0, a\(n\)\=n, and for n such that k \> 0, a\(n\) is the smallest odd prime multiple of a\(k\) that is not already a term\.
https://oeis.org/A356886
## JSON
```JSON
[1, 2, 3, 4, 9, 6, 5, 8, 15, 18, 27, 12, 21, 10, 7, 16, 35, 30, 63, 36, 81, 54, 45, 24, 25, 42, 99, 20, 33, 14, 11, 32, 55, 70, 165, 60, 297, 126, 75, 72, 135, 162, 243, 108, 189, 90, 105, 48, 49, 50, 147, 84, 351, 198, 195, 40, 65, 66, 117, 28, 39, 22, 13, 64, 91]
```
## Mathematica
```Mathematica
nn = 65; c[_] = False; Do[Set[{m, k}, {2, 2^(Ceiling[Log2[n]]) - n}]; If[k == 0, Set[{a[n], c[n]}, {n, True}], While[Set[t, Prime[m] a[k]]; c[t], m++]; Set[{a[n], c[t]}, {t, True}]], {n, nn}]; Array[a, nn] (* _Michael De Vlieger_, Sep 02 2022 *)
```
## PARI
```PARI
first(n) = { my(res = vector(n), m = Map()); for(i = 1, n, qd = ceil(log(i)/log(2)); nextp = 1<<qd; if(nextp == i, res[i] = i , k = res[nextp - i]; forprime(p = 3, oo, if(!mapisdefined(m, k*p), res[i] = k*p; mapput(m, k*p, 1); next(2) ) ) ) ); res } \\ _David A. Corneth_ and _Michel Marcus_, Sep 13 2022
```
## Python
```Python
from itertools import count, islice
from sympy import nextprime
def A356886_gen(): # generator of terms
    aset, alist = {1}, [1]
    yield 1
    for n in count(2):
        if k:=(0 if (i:=1<<n.bit_length())==n<<1 else i-n):
            p, m = 3, alist[k-1]
            while p*m in aset:
                p = nextprime(p)
            r = p*m
        else:
            r = n
        alist.append(r)
        aset.add(r)
        yield r
A356886_list = list(islice(A356886_gen(),30)) # _Chai Wah Wu_, Sep 09 2022
```
