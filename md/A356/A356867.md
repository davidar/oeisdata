# For n \>\= 1, write n \= 3^m \+ k, where m \>\= 0 is the greatest power of 3 <\= n, and k is in the range 0 <\= k < 3^\(m\+1\) \- 3^m, then for n such that k\=0, a\(n\)\=n, and for n such that k \> 0, a\(n\) is the smallest prime multiple p\*a\(k\), p \!\= 3, that is not already a term\.
https://oeis.org/A356867
## JSON
```JSON
[1, 2, 3, 5, 4, 6, 10, 8, 9, 7, 14, 15, 25, 20, 12, 50, 16, 18, 35, 28, 30, 125, 40, 24, 100, 32, 27, 11, 22, 21, 55, 44, 42, 70, 56, 45, 49, 98, 75, 175, 140, 60, 250, 80, 36, 245, 196, 150, 625, 200, 48, 500, 64, 54, 77, 110, 105, 275, 88, 84, 350, 112, 90, 343]
```
## Mathematica
```Mathematica
nn = 64; m = 1; i = 2; p = Prime[i]; c[_] = False; Do[Set[{m, k}, {1, n - p^Floor[Log[p, n]]}]; If[k == 0, Set[{a[n], c[n]}, {n, True}], While[Set[t, Prime[m] a[k]]; Or[m == i, c[t]], m++]; Set[{a[n], c[t]}, {t, True}]], {n, nn}]; Array[a, nn] (* _Michael De Vlieger_, Sep 01 2022 *)
```
## Python
```Python
from sympy import nextprime
from sympy.ntheory import digits
from itertools import count, islice
def b(n): return n - 3**(len(digits(n,3)) - 2)
def agen():
    aset, alst = set(), [None]
    for n in count(1):
        k = b(n)
        if k == 0: an = n
        else:
            ak, p = alst[k], 2
            while p == 3 or p*ak in aset: p = nextprime(p)
            an = p*ak
        yield an; aset.add(an); alst.append(an)
print(list(islice(agen(), 64))) # _Michael S. Branicky_, Sep 02 2022
```
## PARI
```PARI
up_to = 19683;
A356867list(up_to) = { my(v=vector(up_to),met=Map(),h=0,ak); for(i=1,#v,if(1==vecsum(digits(i,3)), v[i] = i; h = i, ak = v[i-h]; forprime(p=2,,if(3!=p && !mapisdefined(met,p*ak), v[i] = p*ak; break))); mapput(met,v[i],i)); (v); };
v356867 = A356867list(up_to);
A356867(n) = v356867[n]; \\ _Antti Karttunen_, Sep 15 2023
```
